/**************************************************
 * Faith-MBTI Test – app.js (Rich Data & Fixed Logic)
 **************************************************/

/* =========================================
   1. 데이터 정의 (풍성한 버전)
   ========================================= */

const originalQuestions = [
  // E / I
  { id: "EI_E1", text: "예배가 끝나면 ‘오늘 은혜 나눌 사람 누구 없나?’ 하며 자연스럽게 사람을 찾는다.", axis: "EI", side: "E" },
  { id: "EI_I1", text: "예배가 끝나면 사람들과 섞이기보다 조용히 혼자 여운을 느끼고 싶다.", axis: "EI", side: "I" },
  { id: "EI_E2", text: "새로운 소그룹에 들어가면 어색한 분위기를 풀려고 먼저 말을 거는 편이다.", axis: "EI", side: "E" },
  { id: "EI_I2", text: "새로운 소그룹에 들어가면 먼저 분위기를 지켜보다가 천천히 참여하는 편이다.", axis: "EI", side: "I" },
  { id: "EI_E3", text: "하루에 사람을 거의 못 만나면 ‘누군가와 얘기하고 싶다’는 생각이 든다.", axis: "EI", side: "E" },
  { id: "EI_I3", text: "사람을 많이 만난 날에는 반드시 혼자만의 충전 시간이 필요하다.", axis: "EI", side: "I" },
  { id: "EI_E4", text: "신앙 고민이 생기면 혼자 결정하기보다 누군가와 상의하고 싶다.", axis: "EI", side: "E" },
  { id: "EI_I4", text: "신앙 고민이 생기면 먼저 내 안에서 충분히 정리한 뒤에 나누고 싶다.", axis: "EI", side: "I" },
  { id: "EI_E5", text: "새로운 사역 제안이 오면 ‘재밌겠다, 해보자!’라는 마음이 먼저 든다.", axis: "EI", side: "E" },
  { id: "EI_I5", text: "새로운 사역 제안이 오면 나와 맞는지, 감당 가능할지부터 조용히 따져보는 편이다.", axis: "EI", side: "I" },
  // S / N
  { id: "SN_S1", text: "설교를 들을 때 구체적으로 ‘내 일상에서 무엇을 바꿔야 할지’가 먼저 떠오른다.", axis: "SN", side: "S" },
  { id: "SN_N1", text: "설교를 들을 때 ‘이 말씀이 우리 공동체에 어떤 그림을 그릴까’를 먼저 떠올린다.", axis: "SN", side: "N" },
  { id: "SN_S2", text: "하나님을 경험할 때 작은 사건과 현실 상황의 변화를 통해 체감하는 편이다.", axis: "SN", side: "S" },
  { id: "SN_N2", text: "하나님을 경험할 때 마음속 깊은 생각과 영감, 그림으로 더 강하게 느끼는 편이다.", axis: "SN", side: "N" },
  { id: "SN_S3", text: "새로운 사역 이야기를 들으면 우선 일정, 장소, 역할 같은 구체적인 정보를 알고 싶다.", axis: "SN", side: "S" },
  { id: "SN_N3", text: "새로운 사역 이야기를 들으면 그 사역이 가진 방향성과 의미가 먼저 궁금하다.", axis: "SN", side: "N" },
  { id: "SN_S4", text: "기도할 때 당장 눈앞의 현실 문제들을 하나씩 올려드리는 편이다.", axis: "SN", side: "S" },
  { id: "SN_N4", text: "기도할 때 하나님이 이끄실 미래의 방향과 그림을 상상하며 기도하는 편이다.", axis: "SN", side: "N" },
  { id: "SN_S5", text: "공동체에서 ‘지금 당장 필요한 것’을 채우는 실질적 섬김에 마음이 끌린다.", axis: "SN", side: "S" },
  { id: "SN_N5", text: "공동체에서 ‘앞으로 어떻게 자라나면 좋을지’를 고민하며 비전을 나누는 데 마음이 끌린다.", axis: "SN", side: "N" },
  // T / F
  { id: "TF_T1", text: "누군가 어려움을 나누면 그 상황을 어떻게 해결할지 방법이 먼저 떠오른다.", axis: "TF", side: "T" },
  { id: "TF_F1", text: "누군가 어려움을 나누면 얼마나 마음이 힘들었을지 먼저 공감부터 된다.", axis: "TF", side: "F" },
  { id: "TF_T2", text: "갈등 상황이 생기면 ‘무엇이 옳고 공정한가’를 먼저 생각한다.", axis: "TF", side: "T" },
  { id: "TF_F2", text: "갈등 상황이 생기면 ‘누가 상처받지 않을까’를 먼저 생각한다.", axis: "TF", side: "F" },
  { id: "TF_T3", text: "말씀을 들을 때 내용의 논리와 구조를 정리하는 편이다.", axis: "TF", side: "T" },
  { id: "TF_F3", text: "말씀을 들을 때 하나님의 마음과 감정이 어떻게 느껴지는지가 더 크게 다가온다.", axis: "TF", side: "F" },
  { id: "TF_T4", text: "사역 회의에서 비효율적이거나 비논리적인 부분이 보이면 바로잡고 싶다.", axis: "TF", side: "T" },
  { id: "TF_F4", text: "사역 회의에서 사람들의 감정과 분위기가 상하지 않는 것이 더 중요하게 느껴진다.", axis: "TF", side: "F" },
  { id: "TF_T5", text: "도움을 요청받았을 때 지금 내가 할 수 있는지 현실적인 가능성을 먼저 판단한다.", axis: "TF", side: "T" },
  { id: "TF_F5", text: "도움을 요청받았을 때 거절하면 상대가 상처받지 않을까를 먼저 떠올린다.", axis: "TF", side: "F" },
  // J / P
  { id: "JP_J1", text: "큐티나 기도는 가능한 한 일정한 시간과 장소를 정해두고 지키는 편이 편하다.", axis: "JP", side: "J" },
  { id: "JP_P1", text: "큐티나 기도는 정해진 틀보다 상황과 느낌에 맞게 자유롭게 하는 편이 더 편하다.", axis: "JP", side: "P" },
  { id: "JP_J2", text: "사역 준비를 할 때 체크리스트를 만들어 하나씩 완수하는 게 마음이 놓인다.", axis: "JP", side: "J" },
  { id: "JP_P2", text: "사역 준비를 할 때 대략적인 그림만 잡고 상황에 맞춰 유연하게 맞추는 편이다.", axis: "JP", side: "P" },
  { id: "JP_J3", text: "모임 시간이나 계획이 갑자기 바뀌면 스트레스를 좀 받는 편이다.", axis: "JP", side: "J" },
  { id: "JP_P3", text: "모임 시간이나 계획이 갑자기 바뀌어도 ‘뭐, 그렇지’ 하며 금방 적응하는 편이다.", axis: "JP", side: "P" },
  { id: "JP_J4", text: "신앙생활에서도 계획적으로 목표를 세우고 체크하는 것이 중요하다고 느낀다.", axis: "JP", side: "J" },
  { id: "JP_P4", text: "신앙생활에서도 계획보다 그때그때 주어지는 기회와 흐름을 따라가는 편이다.", axis: "JP", side: "P" },
  { id: "JP_J5", text: "한 주를 돌아볼 때 무엇을 얼마나 완료했는지가 중요하게 느껴진다.", axis: "JP", side: "J" },
  { id: "JP_P5", text: "한 주를 돌아볼 때 어떤 경험과 만남이 있었는지가 더 중요하게 느껴진다.", axis: "JP", side: "P" }
];

const typeResults = {
  ESTJ: {
    nameKo: "진리의 관리자", nameEn: "The Builder of Order",
    summary: "공동체가 안정적으로 운영되도록 기반을 단단히 세우는 실천형 리더입니다. 시간·안전·준비·예산처럼 대부분이 지나치는 요소를 빠르게 파악하고, 위험이나 혼란의 가능성을 즉각적으로 점검합니다. 복잡한 상황에서도 중심을 잡고 질서를 회복하며, 사람들에게 ‘저 사람이 있으면 괜찮다’는 든든함을 줍니다.",
    badges: ["질서·실행", "원칙·책임", "공동체 리더십"],
    features: [
      "현장을 둘러보고 필요한 위험 요소·준비 상태를 빠르게 체크합니다.",
      "계획·행정·운영·일정 조율에서 안정감을 주며 구조를 탄탄히 세웁니다.",
      "혼란스러운 순간에도 기준을 세우고 흐트러진 상황을 다시 정리하는 능력이 뛰어납니다.",
      "일을 단계별로 나누어 현실적인 계획으로 만들고, 지연되기보다 즉시 실행하려는 성향이 있습니다."
    ],
    growth: [
      "책임감이 엄격함으로 전달되지 않도록, 말의 온도를 한 번만 낮추는 연습이 필요합니다.",
      "효율보다 관계를 먼저 바라보며, 느린 속도나 작은 실수도 여유 있게 받아들이는 훈련을 해보세요.",
      "혼자 모두 짊어지려는 습관에서 벗어나 의도적으로 위임하며 새로운 리더를 세워 보세요.",
      "원칙을 세울 때마다 ‘이 기준이 사람을 살리는가?’를 예수님의 마음으로 한 번 더 점검해 보세요."
    ],
    bibleCharacter: "모세", bibleCharacterDesc: "광야에서 질서를 세우고 백성을 인도했던 리더. 책임감과 충성을 다해 공동체를 붙들었던 모습이 ESTJ와 닮았습니다.",
    verseRef: "민수기 12:7", verseText: "“내 종 모세는 그렇지 아니하니 그는 나의 온 집에 충성됨이라”",
    characterEmoji: "🛡️", characterTitle: "광야 진영의 질서 담당 장교", characterStory: "예배 준비의 시간표·자리·동선·안전 등을 빠르게 파악해 흐트러진 현장을 정돈하는 사람입니다. 모두가 알아차리기 전에 문제를 발견하고 필요한 사람들을 모아 간단하게 브리핑하며, 예배와 모임이 제시간에 안정적으로 흘러가도록 보이지 않는 곳에서 기반을 붙잡아 줍니다. 사람들은 크게 드러나지는 않지만 ‘누군가 뒤에서 잡아줬구나’라는 안도감을 느낍니다.",
    ministries: ["예배/행정 운영 팀", "재정·예산·행정 시스템 정리", "조직 운영 및 리더 훈련 과정 구축", "안전·시설·환경 점검"],
    strengthShort: "책임감과 실행력이 강하고, 위험을 미리 감지하며 안전한 질서를 세우는 데 탁월합니다.",
    weaknessShort: "말투와 태도가 딱딱하게 전달될 수 있으며, 일을 혼자 처리하려다 과부하가 생길 수 있습니다.",
    warningShort: "원칙을 지키는 과정에서 관계가 경직되지 않도록, 말 한마디와 표정의 온도를 한 번 더 바라보면 좋습니다.",
    verseApply: "당신의 충성스러운 섬김 뒤에서 하나님이 공동체를 붙들고 계십니다. 모든 책임을 혼자 지려 하기보다, ‘주님이 이미 책임지고 계신다’는 사실을 고백하며 한 걸음 내려놓아 보세요."
  },
  ESFJ: {
    nameKo: "사랑의 돌봄자", nameEn: "The Nurturing Shepherd",
    summary: "공동체 안에 자연스럽게 ‘정서적 안전지대’를 만드는 사람입니다. 흐려진 표정, 평소와 다른 참석 여부, 조용히 앉아 있는 아이의 분위기까지 세심하게 살피며 먼저 다가갑니다. 스쳐 지나가는 인사 속에서도 지난 대화를 기억해 주어, 사람들에게 ‘나는 잊히지 않았다’는 깊은 위로와 안정감을 선물합니다.",
    badges: ["돌봄·관계", "환대·케어", "공동체 감수성"],
    features: [
      "새가족이나 낯선 이가 어색하지 않도록 먼저 눈을 마주치고 다가가 편안함을 느끼게 합니다.",
      "사람들이 나눴던 작은 이야기·상황·기도 제목을 기억했다가 적절한 때에 다시 물어봐 줍니다.",
      "분위기를 부드럽게 만들고, 서운함과 긴장이 생겼을 때 정서적으로 중재하는 능력이 있습니다.",
      "식사·메시지·방문·선물 등 구체적인 행동으로 사람들의 필요를 채워 주는 섬김에 강점이 있습니다."
    ],
    growth: [
      "모든 사람의 마음을 다 책임지려 하기보다, 나의 한계를 인정하고 ‘경계’를 세우는 연습이 필요합니다.",
      "부탁을 거절하는 것이 사랑의 부정이 아니라, 사랑을 오래 지키기 위한 선택임을 마음에 새겨 보세요.",
      "‘사실–감정–요청’을 정직하게 표현하며, 부드럽지만 분명하게 자신의 상태를 나누는 훈련을 해보세요.",
      "정기적으로 휴식과 회복의 날을 정해 연락·응답을 줄이고, 하나님 앞에서 마음을 비우는 시간을 가져 보세요."
    ],
    bibleCharacter: "마르다", bibleCharacterDesc: "섬김과 환대에 분주하면서도 사랑받는 자리 안에 있었던 마르다처럼, 공동체의 실제 필요를 누구보다 잘 돌보는 모습이 ESFJ와 닮았습니다.",
    verseRef: "요한복음 11:5", verseText: "“예수께서 본래 마르다와 그 동생과 나사로를 사랑하시더니”",
    characterEmoji: "🤲", characterTitle: "따뜻한 식탁을 여는 사람", characterStory: "배고픈 사람, 어색한 사람을 그냥 지나치지 못하고 먼저 음료를 건네고 자리를 내어주는 사람입니다. 당신이 있는 모임에는 ‘내 자리가 있다’고 느끼는 사람이 점점 늘어나고, 공동체는 당신을 통해 부드러운 숨을 쉽니다.",
    ministries: ["새가족 환영·정착", "식사·커피·간식 준비", "소그룹/셀 인도", "병문안·격려 메시지"],
    strengthShort: "사람들을 세심하게 기억하고 돌보며, 공동체에 포근하고 안전한 정서를 만들어 줍니다.",
    weaknessShort: "거절과 한계 설정이 서툴러 마음과 몸이 쉽게 지치고, 속으로 서운함이 쌓일 수 있습니다.",
    warningShort: "모든 사람의 감정을 책임지려다 보면 정작 나 자신의 마음과 하나님과의 깊은 시간을 잃어버릴 수 있습니다.",
    verseApply: "예수께서 마르다를 사랑하셨던 것처럼, 바쁘고 지친 당신의 섬김도 주님의 시선 안에 있음을 기억하게 합니다. 오늘은 누군가를 먼저 챙기기 전에, 하나님 앞에서 나 자신에게 ‘괜찮아, 수고했다’고 말해 주는 회복의 순간을 허락해 보세요."
  },
  ENTJ: {
    nameKo: "비전의 개척자", nameEn: "The Kingdom Strategist",
    summary: "복잡한 상황 속에서도 핵심을 빠르게 추려 내고, 공동체가 향해야 할 방향을 선명하게 제시하는 리더입니다. 흐릿해진 목표 속에서 “지금 우리가 가야 할 길은 여기입니다”라고 말하며 흐름을 재정리하고, 비전을 계획·지표·일정으로 구체화해 실제 움직임을 만들어 갑니다. 당신이 나서는 자리에는 방향과 속도가 동시에 생기고, 흩어져 있던 에너지가 한 목표를 향해 모입니다.",
    badges: ["비전·전략", "개척·확장", "목표 지향"],
    features: [
      "여러 의견이 오가는 가운데서도 핵심 한 줄과 우선순위를 빠르게 정리합니다.",
      "추상적인 비전도 계획·타임라인·역할 분담으로 구체화해 실제 행동으로 연결합니다.",
      "도전적인 과제나 새로운 시도 앞에서 오히려 에너지를 얻으며, 변화를 이끄는 것을 즐깁니다.",
      "회의나 사역 전반에서 흐름이 늘어질 때, 구조를 다시 잡고 결론을 향해 논의를 정리하는 능력이 있습니다."
    ],
    growth: [
      "목표와 일정만큼이나, 함께 걷는 사람들의 속도와 감정을 살피는 연습이 필요합니다.",
      "회의와 사역을 시작하기 전에 몇 분이라도 ‘사람의 이야기’를 먼저 듣는 시간을 의도적으로 만들어 보세요.",
      "중요한 결정의 일부는 의도적으로 위임하며, “잘 안 되어도 함께 책임지겠다”는 메시지를 전해 보세요.",
      "완벽한 계획보다 함께 가는 공동체를 더 기뻐하시는 하나님을 기억하며, ‘하나님의 때’를 기다리는 인내를 훈련해 보세요."
    ],
    bibleCharacter: "느헤미야", bibleCharacterDesc: "무너진 성벽을 재건하기 위해 상황을 파악하고 비전을 선포하며, 사람들을 조직해 실행한 리더. 비전과 전략, 실행력이 조화를 이루는 모습이 ENTJ와 닮았습니다.",
    verseRef: "느헤미야 2:18", verseText: "“그들에게 하나님의 선한 손이 나를 도우신 일과 왕이 내게 이른 말씀을 전하였더니 그들의 말이 일어나 건축하자 하고 모두 힘을 내어 이 선한 일을 하려 했다”",
    characterEmoji: "🧭", characterTitle: "도시 재건 프로젝트 디렉터", characterStory: "비어 있는 공간을 보면 ‘이곳을 통해 하나님이 무엇을 하실 수 있을까?’를 떠올리며, 사람을 모으고 역할을 나누어 실제 변화를 만들어내는 사람입니다. 당신의 노트에는 늘 새로운 프로젝트와 구조도가 가득하지만, 결국 그 중심에는 ‘복음이 더 잘 흘러가도록’이라는 한 문장이 자리잡고 있습니다.",
    ministries: ["교회 비전·전략 수립", "행사·캠페인 총괄", "리더·사역자 멘토링", "사역 구조 진단"],
    strengthShort: "큰 그림과 전략을 제시하고, 사람과 자원을 조직해 실제 변화를 만들어내는 추진력이 탁월합니다.",
    weaknessShort: "목표와 효율에 집중하는 나머지, 느리게 움직이는 사람들의 감정과 속도를 놓칠 위험이 있습니다.",
    warningShort: "사역의 성과와 속도가, 한 사람의 눈물과 마음보다 앞서지 않도록 의도적으로 ‘사람의 이야기’를 먼저 듣는 훈련이 필요합니다.",
    verseApply: "하나님이 시작하신 ‘선한 일’은 당신의 전략과 리더십을 통해 진행되지만, 완성하시는 분은 결국 하나님이심을 기억하게 합니다. 오늘은 회의나 계획을 시작하기 전에 잠시 멈추어, ‘주님, 이 비전과 계획의 주인은 제가 아니라 주님이십니다’라고 고백하며 방향과 속도를 맡겨 보세요."
  },
  ENFJ: {
    nameKo: "감동의 인도자", nameEn: "The Inspirer",
    summary: "사람 안에 숨겨진 가능성을 놀랄 만큼 빠르게 포착하고, 그 가능성을 비전으로 끌어 올리는 감동형 리더입니다. 다른 이들이 보지 못하는 잠재력을 먼저 알아보고, 짧은 한마디로도 큰 용기를 심어 줍니다. 흩어진 이야기를 한 줄로 모으고, 각자의 삶에서 하나님이 일하신 흔적을 보게 하며, 사람들로 하여금 ‘나도 하나님 안에서 걸어갈 수 있겠다’는 소망을 품게 합니다.",
    badges: ["비전·감동", "공감 리더십", "연합"],
    features: [
      "사람 안의 잠재력과 소명을 예리하게 발견하고, 구체적인 문장으로 격려해 줍니다.",
      "이야기와 예시, 간증과 비전 캐스팅을 통해 분위기를 살리고 마음에 불을 붙입니다.",
      "여러 사람의 표정과 분위기를 동시에 읽어, 깊어질 순간과 가볍게 웃을 순간을 직관적으로 구분합니다.",
      "처음 만난 사람도 편안하게 마음을 열고 자신의 이야기를 나누도록 이끄는 능력이 있습니다."
    ],
    growth: [
      "모든 사람의 기대에 다 응답하지 못해도 괜찮다는 사실을 받아들이고, 책임의 한계를 정직하게 인식하는 연습이 필요합니다.",
      "사람의 반응과 평가보다, 하나님이 기뻐하시는 중심과 방향을 다시 붙잡을 때 리더십이 더 자유로워집니다.",
      "‘내가 이 사람을 세워야 한다’는 부담에서 벗어나, ‘하나님이 세우시고 나는 곁에서 돕는다’는 시선을 배우면 번아웃을 예방할 수 있습니다.",
      "정기적으로 혼자 하나님 앞에 서는 시간을 확보하고, 조언보다 질문과 경청을 조금 더 선택하는 훈련을 해보세요."
    ],
    bibleCharacter: "바나바", bibleCharacterDesc: "사람 안의 은혜와 가능성을 보고 위로와 격려로 세웠던 동역자. 사역자를 발굴하고 세우며, 많은 이들을 주님께로 연결했던 모습이 ENFJ와 잘 닮았습니다.",
    verseRef: "사도행전 11:24", verseText: "“바나바는 착한 사람이요 성령과 믿음이 충만한 자라 이에 큰 무리가 주께 더하더라”",
    characterEmoji: "📣", characterTitle: "마음에 불을 붙이는 코치", characterStory: "‘너의 안에 이런 가능성이 보여’라고 구체적으로 짚어 주며, 누군가의 삶의 방향을 바꾸는 한마디를 남기는 사람입니다. 당신의 작은 격려 메시지 하나가, 누군가에게는 사역을 포기하지 않게 만드는 동력이 되고, 공동체의 분위기를 한 번 더 살아나게 합니다.",
    ministries: ["소그룹/청년부 리더", "양육·멘토링", "비전 집회/수련회", "새가족 정착 사역"],
    strengthShort: "사람 안의 가능성을 발견하고 격려하며, 공동체를 하나로 모으는 인도력과 비전·감동을 전염시키는 능력이 탁월합니다.",
    weaknessShort: "모든 사람을 돕고 싶어 하는 마음 때문에 거절이 어렵고, 정서적·영적으로 쉽게 소진될 수 있습니다.",
    warningShort: "타인의 기대와 감정을 모두 품으려다 정작 자신의 영혼과 하나님과의 관계를 돌보지 못할 수 있으니, 나만의 회복 시간과 경계를 의도적으로 지키는 것이 중요합니다.",
    verseApply: "사람을 격려하고 세우는 당신의 말과 시선이 성령 안에서 사용될 때, 많은 이가 주님께 더 가까이 나아가게 됩니다. 오늘은 떠오르는 한 사람을 위해, 하나님 안에서 본 그 사람의 강점과 가능성을 구체적인 한 문장으로 적어 메시지로 보내 보세요."
  },
  ISTJ: {
    nameKo: "믿음의 수호자", nameEn: "The Faithful Keeper",
    summary: "보이지 않는 자리에서 공동체의 기초가 흐트러지지 않도록 묵묵히 붙들어 주는 사람입니다. 예배가 제시간에 시작되고, 헌금·문서·일정·규칙이 혼란 없이 유지되는 배경에는 종종 ISTJ의 성실한 손길이 있습니다. 감정보다 원칙을, 충동보다 질서를 선택하여 공동체가 안정적으로 걸어갈 수 있는 바닥을 만들어 줍니다.",
    badges: ["전통·성실", "안정·책임", "신중함"],
    features: [
      "맡은 일을 끝까지 책임지고, 작은 변화나 누락도 발견해 차분히 바로잡습니다.",
      "재정·문서·운영·기록 등 꼼꼼함이 필요한 영역에서 특별한 강점을 드러냅니다.",
      "익숙하고 검증된 방식에 안정감을 느끼며, 위험을 최소화하는 데 뛰어납니다.",
      "위기 상황에서도 규정과 절차에 따라 침착하게 대응하며 공동체를 지탱합니다."
    ],
    growth: [
      "새로운 시도 앞에서 본능적으로 ‘위험’을 먼저 떠올리기보다, 작은 범위에서 실험해 보는 유연성이 도움이 됩니다.",
      "마음에만 담아두던 감사와 사랑을 말과 따뜻한 표현으로 나누면 관계가 훨씬 깊어집니다.",
      "책임감을 혼자 짊어지지 않도록, 스스로의 피로를 인식하고 적절한 쉼을 ‘책임의 일부’로 받아들이는 연습이 필요합니다.",
      "규칙 자체보다 ‘사람을 세우는 일’을 하나님께서 더 기뻐하심을 자주 상기해 보세요."
    ],
    bibleCharacter: "다니엘", bibleCharacterDesc: "환경이 바뀌어도 기도와 말씀의 삶을 흔들림 없이 지켰던 신실한 자. ISTJ의 꾸준함과 충성을 가장 잘 보여주는 인물입니다.",
    verseRef: "다니엘 6:10", verseText: "“다니엘이 이 조서에 왕의 직인이 찍힌 것을 알고도 자기 집에 돌아가서는 그 방의 예루살렘으로 향하여 열린 창에서 전에 하던대로 하루 세번씩 무릎을 꿇고 기도하며 그의 하나님께 감사하였더라”",
    characterEmoji: "📘", characterTitle: "기도 시간 지키는 기록 담당", characterStory: "예배와 기도 모임의 시간, 기도 제목, 응답을 꼼꼼히 기록하고 잊지 않고 중보하는 숨은 기둥과 같은 사람입니다. 사람들은 잘 보지 못하지만, 하나님 앞에서는 당신의 수첩 한 장 한 장이 귀한 향기로 기억됩니다.",
    ministries: ["재정·문서·기록 사역", "예배 준비·운영", "기도 모임 시간 관리", "시설·안전 점검"],
    strengthShort: "꾸준함과 신실함으로 공동체의 기반을 지키고, 누구보다 안정적인 토대를 세웁니다.",
    weaknessShort: "새로운 시도나 변화에 쉽게 마음이 열리지 않아 경직되어 보일 수 있습니다.",
    warningShort: "익숙한 방식만 고수하다 보면, 하나님이 여시는 새로운 길과 성장의 기회를 놓칠 수 있습니다.",
    verseApply: "작고 성실한 반복이 하나님 나라에서 큰 열매로 이어짐을 보여 줍니다. 오늘도 ‘전에 하던 대로’ 지키는 당신의 작은 기도와 섬김을 하나님께서 기뻐 보고 계심을 기억해 보세요."
  },
  ISFJ: {
    nameKo: "은혜의 섬김자", nameEn: "The Quiet Servant",
    summary: "눈에 띄지 않는 자리에서 공동체를 가장 부드럽게 지탱하는 사람입니다. 사람들이 집에 돌아간 뒤에도 의자를 정돈하고, 떨어진 물건을 주워 놓고, 말없이 필요한 사람을 챙기는 섬세한 손길 속에 당신의 사랑이 담겨 있습니다. 누가 알아주지 않아도, 공동체가 편안함을 느끼도록 ‘환경과 사람을 돌보는 일’ 자체에 진심을 쏟는 헌신형 제자입니다.",
    badges: ["헌신·돌봄", "안정·배려", "온유함"],
    features: [
      "연약한 사람, 소외되기 쉬운 사람의 분위기를 잘 살피고 조용히 다가갑니다.",
      "티 내지 않고 필요한 일을 스스로 알아서 챙기는 ‘숨은 일꾼’의 면모가 강합니다.",
      "한 번 맡은 관계와 사역을 오래, 꾸준히 책임지며 중간에 쉽게 내려놓지 않습니다.",
      "작은 선물, 메모, 메시지 등 섬세한 표현으로 사람을 위로하고 지지하는 데 능숙합니다."
    ],
    growth: [
      "자신의 필요와 한계를 솔직하게 나누는 연습이 필요합니다. ‘나도 돌봄이 필요한 사람’이라는 사실을 잊지 마세요.",
      "도움을 요청하는 것은 약함이나 민폐가 아니라, 건강한 공동체가 자라는 자연스러운 과정임을 배워 가면 좋습니다.",
      "감정을 계속 눌러두지 말고, 신뢰할 수 있는 사람과 함께 나누는 시간을 정기적으로 가져 보세요.",
      "하나님 앞에서 ‘저는 괜찮아요’ 대신 ‘주님, 저도 힘듭니다’라고 고백하는 기도를 자신에게 허락해 보세요."
    ],
    bibleCharacter: "룻", bibleCharacterDesc: "시어머니와 함께 끝까지 남아 헌신한 인물로, 조용하지만 깊은 충성과 사랑을 보여 줍니다. 보이지 않는 자리에서 끝까지 함께하는 모습이 ISFJ와 닮았습니다.",
    verseRef: "룻기 1:16", verseText: "룻이 이르되 나로 어머니를 떠나며 어머니를 따르지 말고 돌아가라 강요하지 마옵소서 어머니께서 가시는 곳에 나도 가고 어머니께서 머무시는 곳에서 나도 머물겠나이다 어머니의 백성이 나의 백성이 되고 어머니의 하나님이 나의 하나님이 되시리니",
    characterEmoji: "🍞", characterTitle: "끝까지 남아 설거지하는 동역자", characterStory: "모임이 끝난 후, 사람들이 다 돌아간 뒤에도 마지막까지 남아 의자를 정리하고, 바닥을 쓸며, 다음 모임을 준비하는 사람입니다. 아무도 부탁하지 않았지만, 당신은 사랑 때문에 그렇게 움직입니다. 그리고 하나님은 그 손길 하나하나에 ‘잘했다’고 미소 지으십니다.",
    ministries: ["안내·봉사·식당 섬김", "소외된 지체 돌봄", "영유아/유치부 교사", "숨은 중보기도"],
    strengthShort: "섬세하고 꾸준한 섬김으로 사람들에게 안전함과 편안함을 주며, 공동체에 깊은 신뢰를 쌓습니다.",
    weaknessShort: "자신의 필요를 숨기고 혼자 견디다가 지칠 위험이 크고, 마음에 쌓인 서운함을 잘 표현하지 못할 수 있습니다.",
    warningShort: "습관처럼 말하는 ‘저는 괜찮아요’ 뒤에 숨은 마음의 신호를 놓치지 않도록, 스스로의 한계를 인정하는 연습이 필요합니다.",
    verseApply: "당신의 조용한 헌신도 하나님께 분명히 기록되고 있으며, 그 길 끝에 예비된 은혜가 있음을 보여 줍니다. 오늘은 늘 혼자 감당하던 일 중 한 가지를 ‘함께 하자’고 부탁해 보고, 모든 짐을 혼자 지려 하지 않는 연습을 해 보세요."
  },
  INTJ: {
    nameKo: "지혜의 설계자", nameEn: "The Vision Architect",
    summary: "어떤 상황에서도 먼저 ‘전체 그림’을 본 뒤 움직이는 사색가형 리더입니다. 문제를 들으면 감정보다 흐름과 원인을 분석하고, 장기적인 방향과 구조를 떠올리며 “장기적으로는 어떻게 바뀌어야 할까?”를 고민합니다. 말수는 적지만, 필요한 순간 내놓는 한 마디의 통찰로 복잡한 상황을 정리하고, 공동체가 더 건강한 방향으로 가도록 돕는 조용한 설계자입니다.",
    badges: ["통찰·체계", "기획·분별", "전략가"],
    features: [
      "복잡한 개념과 상황에서 패턴을 읽어내고, 전체 그림을 구조화해 핵심만 뽑아내는 능력이 있습니다.",
      "양육·훈련·사역 로드맵처럼 중장기적인 과정을 설계하고 정리하는 일에 잘 어울립니다.",
      "감정에 휘둘리기보다, 무엇이 옳고 장기적으로 유익한 방향인지 냉정하게 판단하려고 합니다.",
      "한 번 정리해 둔 시스템과 프로세스를 계속 점검·개선하며, 더 효율적이고 사람을 돕는 방향으로 다듬는 것을 좋아합니다."
    ],
    growth: [
      "머릿속에만 가지고 있던 좋은 아이디어를 실제로 꺼내어 나누고, 완벽하지 않아도 함께 실험해 보는 연습이 필요합니다.",
      "충분히 준비된 뒤에 움직이려는 완벽주의를 조금 내려놓고, ‘작은 단위의 실행’부터 시작해 보세요.",
      "계획과 구조는 사람을 돕기 위한 도구이지, 사람보다 앞설 수 없다는 사실을 자주 상기하는 것이 중요합니다.",
      "새로운 구조나 사역을 설계할 때 정기적으로 ‘이 안에서 실제 사람들은 어떻게 느끼고 있을까?’를 묻고, 직접 피드백을 듣는 연습을 해 보세요."
    ],
    bibleCharacter: "사도 바울", bibleCharacterDesc: "복음의 큰 그림과 교회의 구조를 깊이 고민하며 서신으로 정리한 전략가적 사도입니다. 신학적 통찰과 실제 교회의 삶을 연결한 모습이 INTJ와 잘 닮았습니다.",
    verseRef: "골로새서 1:28", verseText: "우리가 그를 전파하여 각 사람을 권하고 모든 지혜로 각 사람을 가르침은 각 사람을 그리스도 안에서 완전한 자로 세우려 함이니",
    characterEmoji: "♟️", characterTitle: "사역 로드맵 설계자", characterStory: "단순히 ‘지금 잘 되는 것’보다, 1년·3년 이후를 내다보며 훈련과 제자 양육의 과정을 설계하는 사람입니다. 당신의 노트에는 다이어그램과 화살표가 가득하지만, 그 화살표는 결국 ‘각 사람을 그리스도 안에서 온전한 자로 세우려는 길’을 향하고 있습니다.",
    ministries: ["양육·훈련 커리큘럼 개발", "중장기 전략 기획", "교리 교육 및 성경공부", "사역 평가 및 분석"],
    strengthShort: "깊이 있고 체계적인 통찰로 방향을 제시하고, 장기적인 성장을 돕는 구조를 설계하는 능력이 탁월합니다.",
    weaknessShort: "계획과 이상이 현실보다 앞서가 실행을 미루기 쉽고, 감정 표현이 적어 차갑게 느껴질 수 있습니다.",
    warningShort: "생각과 설계가 너무 앞서가면, 지금 눈앞에 있는 사람의 마음과 오늘 필요한 작은 순종을 놓칠 수 있습니다.",
    verseApply: "당신이 고민하는 모든 구조와 계획의 중심에는 결국 ‘각 사람을 그리스도 안에서 온전한 자로 세우려 함’이 있음을 상기시켜 줍니다. 오늘은 설계도보다 먼저 한 사람의 이름을 떠올리고, 그를 위한 짧은 기도 한 줄을 적어 보며 하나님께 그 사람의 성장을 맡겨 보세요."
  },
  INFJ: {
    nameKo: "영혼의 안내자", nameEn: "The Spiritual Guide",
    summary: "표면적인 말보다 그 뒤에 숨은 감정과 흐름을 먼저 느끼는 영적 감수성의 사람입니다. 조급한 조언보다 조용한 질문과 침묵으로 마음이 스스로 열릴 시간을 지켜 주며, 많은 이에게 ‘안전하게 들을 수 있는 공간’을 만들어 줍니다. 하나님의 마음과 사람의 마음 사이를 잇는 다리 역할을 자연스럽게 수행하는 조용한 동행자입니다.",
    badges: ["직관·묵상", "의미·치유", "통찰력"],
    features: [
      "사람의 말 이면에 있는 감정·동기·상처를 민감하게 읽어냅니다.",
      "기도와 묵상 속에서 하나님의 뜻과 흐름을 깊이 탐색하는 것을 좋아합니다.",
      "양육, 상담, 영적 동행처럼 깊은 관계 안에서 의미를 찾는 경향이 있습니다.",
      "공동체 안에서는 적은 수의 사람이라도 끝까지 책임지고 진심으로 동행하려는 마음이 큽니다."
    ],
    growth: [
      "통찰을 마음속에만 간직하지 말고, 안전한 관계 안에서 나누어 함께 분별하는 연습이 필요합니다.",
      "타인의 감정을 너무 많이 짊어지지 않도록 감정·책임·진리의 경계를 세우는 것이 중요합니다.",
      "완벽한 이해보다 작은 순종의 발걸음이 먼저일 때도 있음을 기억하세요.",
      "혼자서 모든 짐을 지려 하기보다 ‘내가 감당할 부분’과 ‘하나님께 맡길 부분’을 분리하여 인식하는 연습을 해보세요."
    ],
    bibleCharacter: "사도 요한", bibleCharacterDesc: "사랑과 친밀함을 깊이 강조하며 하나님의 마음을 서술한 제자입니다. 내면과 의미를 중요하게 여기는 INFJ의 성향과 잘 닮아 있습니다.",
    verseRef: "요한일서 4:16", verseText: "우리가 사랑 안에 거하고 하나님은 우리 안에 거하시는 줄을 알고 믿었노니 하나님은 사랑이시라 사랑 안에 거하는 자는 하나님 안에 거하고 하나님도 그의 안에 거하시느니라",
    characterEmoji: "🌙", characterTitle: "조용히 듣는 영혼 상담자", characterStory: "시끄러운 그룹 토론보다, 한 사람과 깊이 이야기 나누는 시간을 더 좋아하는 사람입니다. 당신의 조용한 한마디가 누군가에게는 인생의 전환점이 되기도 하고, 부드러운 눈물 한 방울이 그 사람의 마음에 긴 위로를 남기기도 합니다.",
    ministries: ["상담·돌봄·멘토링", "중보기도 사역", "글쓰기 및 묵상 나눔", "치유 사역"],
    strengthShort: "사람의 내면을 깊이 이해하고 영적으로 안내하며, 치유와 의미의 흐름을 만들어 내는 능력이 탁월합니다.",
    weaknessShort: "여러 감정을 깊이 받아들이다 정서적으로 쉽게 지칠 수 있고, 과공감 피로에 취약할 수 있습니다.",
    warningShort: "타인의 아픔을 너무 깊이 품다 보면 정작 자신의 심령이 먼저 무너질 수 있으므로, 경계와 쉼이 반드시 필요합니다.",
    verseApply: "하나님의 사랑 안에 먼저 머물 때, 복잡한 감정과 이야기 속에서도 길을 잃지 않게 됩니다. 오늘은 누군가를 위해 기도하기 전에 먼저 ‘주님의 사랑 안에 머무는 기도’를 드리며 마음을 하나님 앞에 고요히 놓아 보세요."
  },
  ESTP: {
    nameKo: "행동의 사명자", nameEn: "The Field Warrior",
    summary: "말보다 몸이 먼저 움직이는 해결사형 제자입니다. 길어진 논의 속에서는 답답함을 느끼고, 직접 현장에 가서 상황을 눈으로 보고 손으로 만질 때 비로소 집중이 잘 됩니다. 위기나 돌발 상황 앞에서도 놀라기보다 주변을 재빨리 살피며 ‘지금 가장 먼저 해야 할 일’을 파악하고, 필요한 자리에 먼저 발을 내딛는 사람입니다.",
    badges: ["실행·도전", "현장 중심", "해결사"],
    features: [
      "필요와 문제를 보면 머리로만 고민하기보다 먼저 몸이 움직여 즉각적인 도움을 줍니다.",
      "위기 상황이나 예기치 않은 문제 속에서도 침착하게 현실적인 해결책을 찾으려 합니다.",
      "전도·봉사·구제·재난 대응 등 ‘현장’이 있는 사역에서 가장 큰 에너지와 집중력을 발휘합니다.",
      "사람들이 두려워하거나 망설이는 상황에서도 먼저 나서 분위기를 전환시키고 용기를 불어넣는 힘이 있습니다."
    ],
    growth: [
      "움직이기 전에 단 30초만이라도 멈추어, 말씀과 기도로 방향을 점검하는 습관이 필요합니다.",
      "즉흥적인 실행과 빠른 해결뿐 아니라, 장기적인 책임과 관계도 함께 세우는 연습을 해보세요.",
      "머릿속에서만 정리하지 말고, 감정과 생각을 말로 풀어내면 동역자와의 신뢰와 협력이 훨씬 깊어집니다.",
      "‘나 혼자 해결해야 한다’는 부담을 내려놓고, 시작할 때부터 팀과 역할을 나누어 함께 움직이는 법을 배워 보세요."
    ],
    bibleCharacter: "베드로", bibleCharacterDesc: "생각보다 먼저 발을 내딛는 행동파 제자. 충동도 있었지만, 주님을 향한 사랑 때문에 크게 쓰임 받은 인물입니다.",
    verseRef: "마태복음 14:29", verseText: "오라 하시니 베드로가 배에서 내려 물 위로 걸어서 예수께로 가되",
    characterEmoji: "🚀", characterTitle: "현장 제일주의 해결사", characterStory: "누군가 쓰러졌다는 소식을 들으면 가장 먼저 뛰어나가고, 현장에서 손이 더럽혀지는 것을 두려워하지 않는 사람입니다. 당신 덕분에 현장은 빨리 정리되고, 도움을 받은 사람은 ‘교회가 정말 나를 사랑하는구나’를 몸으로 느끼게 됩니다.",
    ministries: ["아웃리치·선교", "행사 진행·레크리에이션", "시설 보수·긴급 구호", "차량 봉사"],
    strengthShort: "두려움 없이 현장에 뛰어들어 실제적인 도움을 주고, 빠른 실행으로 변화를 이끌어내는 능력이 탁월합니다.",
    weaknessShort: "충동적으로 먼저 움직이며 계획·조율·안전 점검을 놓칠 수 있고, 위험을 가볍게 여길 때가 있습니다.",
    warningShort: "열심히 뛰어가더라도 기도와 분별 없이 앞서 나가면, 지치고 방향을 잃기 쉽다는 것을 기억할 필요가 있습니다.",
    verseApply: "주님을 향해 과감하게 뛰어드는 당신의 용기를 격려하면서도, 그 시선이 끝까지 예수님께 고정되기를 초대하는 말씀입니다. 오늘은 어떤 행동을 시작하기 전에 30~60초만 눈을 감고, ‘주님, 이 선택이 정말 주님이 원하시는 우선인가요?’라고 조용히 물어보는 시간을 가져 보세요."
  },
  ESFP: {
    nameKo: "기쁨의 찬양자", nameEn: "The Joyful Worshiper",
    summary: "밝은 에너지와 따뜻한 환대로 사람들의 마음을 자연스럽게 여는 예배자입니다. 음악, 표정, 말투 같은 작은 표현 하나로 분위기를 부드럽게 만들고, 처음 온 이들도 ‘여긴 편안하다’는 인상을 받을 만큼 공간의 공기를 바꾸는 힘이 있습니다. 당신의 존재 자체가 공동체 안에 생기를 불어넣고, 그 기쁨 속에서 사람들은 자연스럽게 하나님께 마음을 열기 시작합니다.",
    badges: ["기쁨·표현", "환대·격려", "분위기 메이커"],
    features: [
      "찬양·춤·예술 등 몸과 감정으로 하나님께 반응하며 예배하는 것을 좋아합니다.",
      "밝은 표정과 유쾌한 말투로 어색한 분위기를 풀고, 처음 온 사람도 금세 편안하게 느끼게 합니다.",
      "모임·행사에서 분위기를 살리고 참여를 이끌어 내는 즉흥성과 감각이 뛰어납니다.",
      "슬퍼하는 사람 곁에서는 조용히 함께 있어 주며, 눈물과 웃음을 함께 나누는 따뜻함을 가지고 있습니다."
    ],
    growth: [
      "감정이 좋지 않은 날에도, 짧은 말씀 묵상과 작은 기도 습관으로 신앙의 리듬을 지키는 연습이 필요합니다.",
      "재정·시간 관리 등 보이지 않는 질서를 세울수록, 기쁨과 에너지가 더 안정적으로 유지됩니다.",
      "슬플 때도 ‘괜찮은 척’하기보다, 있는 그대로의 감정을 하나님께 솔직히 올려 드리는 경험이 중요합니다.",
      "사람들 앞에서의 ‘재미있는 나’와 하나님 앞에서의 ‘있는 그대로의 나’를 구분하고, 후자로 머무는 개인 예배 시간을 자주 가져 보세요."
    ],
    bibleCharacter: "다윗", bibleCharacterDesc: "춤추며 하나님을 찬양하고, 시를 통해 기쁨과 슬픔을 솔직히 쏟아낸 예배자입니다. 감정을 숨기지 않고 하나님께 표현했던 모습이 ESFP와 잘 닮았습니다.",
    verseRef: "시편 103:1", verseText: "내 영혼아 여호와를 송축하라 내 속에 있는 것들아 다 그분의 거룩한 이름을 송축하여라",
    characterEmoji: "🎉", characterTitle: "축제 예배 리드보컬", characterStory: "박수와 춤, 표정으로 예배의 분위기를 활짝 열어 주는 사람입니다. 당신의 손짓 하나, 미소 하나에 분위기가 달라지고, 사람들은 점점 더 자유롭게 찬양하며 하나님께 나아갑니다. 때로는 조용한 곡에서 눈물을 훔치며, 진짜 위로를 받기도 합니다.",
    ministries: ["찬양팀·워십", "교회학교 교사", "환영·친교 사역", "문화 행사 기획"],
    strengthShort: "사람들을 즐겁게 하고 예배와 모임의 분위기를 활짝 열어, 하나님께 마음을 여는 문을 만들어 줍니다.",
    weaknessShort: "감정에 따라 영적 리듬이 쉽게 흔들릴 수 있고, 속마음을 숨긴 채 ‘밝은 모습’을 유지하려 할 수 있습니다.",
    warningShort: "즐거운 분위기 뒤에 감추어진 자신의 슬픔과 공허함을 무시하지 않도록, 마음의 신호에 귀 기울일 필요가 있습니다.",
    verseApply: "기쁨의 분위기를 넘어, 마음 깊은 곳에서 하나님을 찬양하는 예배자로 부르심을 상기시켜 줍니다. 오늘은 시편 한 편을 소리 내어 읽으며, 기쁨뿐 아니라 슬픔과 두려움까지도 솔직히 고백하며 그분께 올려 드려 보세요."
  },
  ENTP: {
    nameKo: "창의적 변증가", nameEn: "The Faith Innovator",
    summary: "사람들이 당연하게 넘기는 지점에서 ‘왜요?’라고 묻는 탐구형 리더입니다. 이 질문은 비판이 아니라 더 깊은 이해를 향한 움직임이며, 신앙·문화·전통·사회가 부딪히는 지점에서도 두려움 없이 본질을 파고들어 새로운 관점을 제시합니다. 당신이 있는 자리에서는 대화가 깊어지고, 굳어 있던 생각의 틀이 자연스럽게 흔들리며, 더 넓은 가능성이 열립니다.",
    badges: ["창의·아이디어", "변증·토론", "혁신가"],
    features: [
      "복잡한 주제를 다양한 각도에서 바라보고 새로운 언어로 설명하는 재능이 있습니다.",
      "토론·질문·대화를 통해 서로의 생각을 확장시키는 데 즐거움을 느낍니다.",
      "새로운 플랫폼(미디어·온라인·콘텐츠)에 대한 두려움이 적고 실험을 좋아합니다.",
      "전통과 관습 속에 숨은 본질을 점검하며 ‘왜 이렇게 해야 하지?’라는 질문을 자주 던집니다."
    ],
    growth: [
      "아이디어를 시작만 하지 말고 작은 단위라도 끝까지 완주하는 훈련이 필요합니다.",
      "상대를 이기기 위한 토론이 아니라, 복음을 드러내고 사람을 세우는 대화를 목표로 삼을 때 건강해집니다.",
      "교회의 전통과 질서를 무시하기보다, 사랑 안에서 질문하고 제안하는 태도를 길러야 합니다.",
      "내 생각을 말하기 전에 ‘지금 이 자리에서 가장 사랑이 되는 말은 무엇일까?’를 먼저 떠올려 보세요."
    ],
    bibleCharacter: "바울(아레오바고의 바울)", bibleCharacterDesc: "각 도시에서 회당과 광장에서 사람들과 토론하며 복음을 변증했던 사도입니다. 논리와 열정을 결합해 복음을 다양한 문화 속에서 설명했던 모습이 ENTP와 닮았습니다.",
    verseRef: "사도행전 17:17", verseText: "바울이 회당에서는 유대인들과 경건한 사람들과 또 저자에서는 날마다 만나는 사람들과 변론하니",
    characterEmoji: "💡", characterTitle: "아이디어 폭주 토론가", characterStory: "어떤 주제든 새로운 각도에서 질문을 던지고, 사람들의 생각의 틀을 넓혀 주는 대화를 이끄는 사람입니다. 가끔은 ‘또 시작이다’라는 반응을 듣지만, 시간이 지나면 많은 이가 당신 덕분에 더 깊이 믿음을 고민하게 되었음을 고백합니다.",
    ministries: ["변증 및 전도", "새로운 사역 기획", "청년부 소그룹(토론)", "미디어/콘텐츠"],
    strengthShort: "창의적인 관점과 논리로 새로운 길을 열고, 복음을 시대의 언어로 설명하는 능력이 탁월합니다.",
    weaknessShort: "안정성과 일관성이 부족해 보일 수 있으며, 논쟁의 승패에 마음이 기울면 관계가 소홀해질 위험이 있습니다.",
    warningShort: "이기기 위한 논쟁이 되면 상대의 마음과 복음의 본질을 놓칠 수 있으니, ‘연결’을 우선순위에 두는 것이 중요합니다.",
    verseApply: "당신의 질문과 논리가 사람을 꺾는 무기가 아니라, 복음을 더 깊이 이해하게 하는 통로가 되도록 이끄는 말씀입니다. 오늘은 대화를 시작하기 전에 상대의 말을 한 문장으로 요약해 주고, ‘내가 맞다’보다 ‘함께 진리에 가까워지자’는 마음으로 대화를 열어 보세요."
  },
  ENFP: {
    nameKo: "열정의 전도자", nameEn: "The Passionate Storyteller",
    summary: "스토리와 진심으로 마음의 문을 여는 전도자형 리더입니다. 자신의 상처와 회복을 숨기지 않고 자연스럽게 나누기 때문에, 듣는 이들은 ‘나만 그런 게 아니구나’라는 위로를 받습니다. 굳어 있던 모임도 당신의 한마디로 분위기가 금세 따뜻해지고, 그 안에서 사람들은 ‘나도 하나님을 다시 만나 보고 싶다’는 소망을 품게 됩니다.",
    badges: ["열정·영감", "스토리·전도", "관계 중심"],
    features: [
      "간증과 스토리를 통해 복음을 생생하고 매력적인 이야기로 들려주는 재능이 있습니다.",
      "새로운 사람·새로운 모임·새로운 시도를 두려워하지 않고 기쁘게 도전합니다.",
      "사람 안의 가능성을 직관적으로 보고, “우리 한번 해 볼래요?”라며 함께 꿈꾸고 격려하는 것을 좋아합니다.",
      "분위기를 살리면서도, 중요한 순간에는 자신의 연약함과 진심을 솔직하게 털어놓을 줄 압니다."
    ],
    growth: [
      "비전과 열정을 실제 일정표와 루틴 속에 뿌리내리는 연습이 필요합니다.",
      "많은 아이디어 중 이번 시즌에 집중할 ‘단 하나’를 정하고, 끝까지 완주하는 경험을 쌓아 보세요.",
      "감정의 파도가 잦아드는 시기에도, 작고 구체적인 순종을 계속 이어 가는 법을 배워 가는 것이 중요합니다.",
      "지금 느끼는 감정보다, 하나님이 이미 약속하신 진리를 붙드는 훈련을 통해 영적 리듬을 안정시켜 보세요."
    ],
    bibleCharacter: "사마리아 여인", bibleCharacterDesc: "예수를 만난 후 자신의 이야기를 가지고 마을 사람들에게 기쁜 소식을 전했던 인물입니다. 은혜의 경험을 ‘와서 보라’는 한 문장으로 풀어낸 모습이 ENFP의 스토리 전도와 잘 닮았습니다.",
    verseRef: "요한복음 4:29", verseText: "나의 행한 모든 일을 내게 말한 사람을 와 보라 이는 그리스도가 아니냐 하니",
    characterEmoji: "🔥", characterTitle: "이야기로 전도하는 스토리텔러", characterStory: "하나님께 받은 작은 감동도 이야기로 풀어내며, 주변 사람들의 마음에 불씨를 옮겨 심는 사람입니다. 당신이 나누는 ‘작은 간증’을 모아, 공동체 안에 ‘나도 다시 시작해 보고 싶다’는 소망이 생겨나고, 잃어버린 양들이 다시 교회의 문을 두드리기도 합니다.",
    ministries: ["관계 전도", "문화/예술 사역", "새가족 환영", "간증/스토리 나눔"],
    strengthShort: "사람들의 마음에 믿음의 용기와 열정을 불어넣고, 복음을 살아 있는 이야기로 전하는 능력이 탁월합니다.",
    weaknessShort: "시작은 빠르지만 계획과 마무리가 약해, 아이디어와 시도가 중간에 흩어질 위험이 있고 감정 기복에 따라 사역의 리듬이 흔들릴 수 있습니다.",
    warningShort: "감정과 열정이 식는다고 해서 하나님이 멀어지신 것은 아니라는 사실을 잊지 말아야 합니다.",
    verseApply: "당신의 스토리와 감동을 통해 많은 사람이 예수님을 보고 싶어지도록 이끄는 삶으로 부르심을 확인하게 합니다. 오늘은 한 사람을 떠올리며, 그에게 들려줄 수 있는 3분 간증을 간단히 적어 보고, 실제로 나누는 한 걸음을 내딛어 보세요."
  },
  ISTP: {
    nameKo: "묵묵한 실천가", nameEn: "The Quiet Helper",
    summary: "말보다 행동으로 사랑을 보여주는 사람입니다. 상황을 빠르게 파악한 뒤 감정에 휘둘리지 않고 본질적인 도움을 건네는 ‘조용한 해결사’입니다. 누군가 말 없이 곁에 있어 주는 위로가 필요할 때, 가장 큰 힘이 되어 주는 유형입니다.",
    badges: ["실용·침착", "조용한 도움", "기술자"],
    features: [
      "문제가 생기면 불안해하기보다 차분히 상황을 살피고 필요한 행동을 빠르게 선택합니다.",
      "감정을 과하게 드러내지 않지만, 위기 순간에는 누구보다 든든한 안정감을 줍니다.",
      "조용히 필요한 일을 처리하며, 누군가 힘들어 보이면 말없이 다가가 돕는 편입니다.",
      "복잡한 상황도 단순하게 정리하여 ‘지금 당장 해야 할 것’을 정확히 보는 능력이 있습니다."
    ],
    growth: [
      "혼자 해결하려 하기보다, 필요한 정보와 과정을 주변과 간단하게라도 나누는 연습이 필요합니다.",
      "말로 감정을 표현하지 않아 오해를 살 수 있으므로, 가까운 사람에게는 솔직한 한 문장을 시도해 보세요.",
      "도움을 받는 것도 건강한 관계의 일부임을 배우면, 섬김이 훨씬 더 지속 가능합니다.",
      "‘내가 다 해야 한다’가 아니라 ‘하나님은 함께 일할 사람을 이미 준비하신다’는 믿음 속에서 일해 보세요."
    ],
    bibleCharacter: "브살렐", bibleCharacterDesc: "겉으로 드러나지 않는 자리에서 정교하게 성막을 지어 올린 장인. 조용한 집중력과 실력으로 하나님의 일을 완성했습니다.",
    verseRef: "출애굽기 31:3", verseText: "“하나님의 영을 그에게 충만하게 하여서 지혜와 총명과 지식과 여러 가지 일을 하게 하였다”",
    characterEmoji: "🛠️", characterTitle: "조용한 장인의 손길", characterStory: "어떤 이는 말로 위로하고, 어떤 이는 격려로 사람을 세웁니다. ISTP는 말보다 한 번의 행동으로 공동체를 지탱합니다. 예배 전후 아무도 요청하지 않은 작은 일들을 조용히 챙기고, 누군가 힘들어 보이면 말없이 옆자리를 지켜주는 따뜻함으로 공동체를 숨 쉬게 합니다. 사람들이 미처 알아채지 못한 그 한 걸음이, 누군가에겐 큰 위로가 되곤 합니다.",
    ministries: ["방송/음향/미디어", "시설 관리/건축", "차량 봉사", "행사 지원"],
    strengthShort: "상황을 명확히 보고, 불필요한 소음 없이 필요한 도움을 정확하게 건네는 ‘실질적 안정감’을 제공합니다.",
    weaknessShort: "감정 표현이 적어 거리감 있게 느껴질 수 있고, 혼자 떠안는 경향 때문에 쉽게 지칠 수 있습니다.",
    warningShort: "혼자 모든 일을 감당하려다 자신의 마음과 영적 상태를 챙기지 못하는 위험이 있습니다.",
    verseApply: "하나님은 당신의 조용한 실천 속에서도 선하게 일하고 계십니다. 오늘은 작은 행동 하나를 마친 뒤, ‘주님, 이 수고를 당신께 드립니다’라고 짧게 고백해 보세요."
  },
  ISFP: {
    nameKo: "온유한 예배자", nameEn: "The Gentle Artist",
    summary: "온유와 아름다움으로 공동체를 따뜻하게 하는 예배자입니다. 크게 드러나지 않는 섬김 속에서 마음을 전하는 것이 당신의 방식입니다. 반주를 맡고, 공간을 조용히 정리하고, 색감 하나·조명 하나를 부드럽게 조정하는 작은 손길 속에 진심이 담겨 있습니다. 당신이 손을 거친 예배 공간에는 설명하기 어려운 평안이 흐르고, 사람들은 자연스럽게 더 머물고 싶어집니다.",
    badges: ["온유·아름다움", "예술·감성", "배려"],
    features: [
      "음악·그림·디자인·공예 등 예술적 재능으로 예배와 공간을 아름답게 꾸미는 일을 좋아합니다.",
      "많은 사람보다 한 사람에게 깊이 헌신하며, 섬세하게 돌보는 편입니다.",
      "조용한 배려와 작은 디테일로 따뜻하고 부드러운 분위기를 만드는 데 자연스러운 재능이 있습니다.",
      "큰 소리의 표현보다 작은 제스처와 작품, 손글씨 등으로 마음을 표현할 때 더 편안함을 느낍니다."
    ],
    growth: [
      "갈등을 피하기보다, 부드럽지만 분명하게 자신의 생각을 표현하는 연습이 필요합니다.",
      "‘저는 이 부분이 조금 힘들어요’와 같은 나의 마음을 드러내는 문장이 내 마음을 지키는 건강한 방법이 될 수 있음을 기억하세요.",
      "남을 위해 희생하는 것만큼, 하나님 안에서 자신을 돌보는 시간(휴식·산책·예술적 묵상)을 정기적으로 확보하는 것이 중요합니다.",
      "‘내가 싫은 말’을 하는 것이 때로는 사랑의 표현이 될 수 있다는 것을 배우며, 진심을 담아 경계를 세우는 연습을 해 보세요."
    ],
    bibleCharacter: "향유를 부은 여인", bibleCharacterDesc: "값비싼 향유를 조용히 부어 사랑을 표현한 예배자입니다. 말보다 행동과 아름다운 헌신으로 주님께 마음을 드린 모습이 ISFP와 닮았습니다.",
    verseRef: "마가복음 14:8", verseText: "저가 힘을 다하여 내 몸에 향유를 부어 내 장사를 미리 준비하였느니라",
    characterEmoji: "🎨", characterTitle: "색과 음악으로 예배하는 아티스트", characterStory: "사소한 장식 하나, 배경 음악 하나에도 마음을 담는 사람입니다. 당신의 손길이 닿는 곳마다 ‘은근한 아름다움’이 배어 나고, 사람들은 왜인지 모르게 그 공간에서 조금 더 오래 머물고 싶어집니다.",
    ministries: ["예술/데코/디자인", "일대일 돌봄", "영유아부", "찬양/반주"],
    strengthShort: "온유하고 따뜻한 예술적 표현으로 사람들의 마음을 위로하고, 예배와 공동체에 은근한 아름다움을 더합니다.",
    weaknessShort: "갈등과 비판을 두려워해 자신의 의견을 숨기기 쉽고, 상처와 서운함을 마음에 오래 담아둘 수 있습니다.",
    warningShort: "조용히 참고만 있다 보면, 말하지 못한 감정이 마음속에 쌓였다가 어느 날 한 번에 터질 수 있습니다.",
    verseApply: "보이는 성과보다 마음을 다한 작은 헌신을 기쁘게 받으시는 주님의 마음을 보여 주는 말씀입니다. 오늘은 떠오르는 한 사람을 위해 작은 그림, 손글씨 메모, 음악 링크 하나라도 정성껏 준비해 건네며, 그 사람을 주님의 위로 안에 맡겨 보세요."
  },
  INTP: {
    nameKo: "진리의 탐구자", nameEn: "The Theological Thinker",
    summary: "무엇이든 ‘정확하게’ 이해하고 싶어 하는 사색가형 예배자입니다. 막연한 설명이나 감정적인 주장보다 “이 의미는 무엇인가?”, “이 구조는 어떻게 연결되는가?”를 먼저 살피며, 머릿속에서 성경·교리·세계관을 조용히 정리해 가는 편입니다. 겉으로는 말수가 적어 보여도 내면에서는 늘 분석·탐구·분별이 동시에 흐르고 있습니다.",
    badges: ["논리·탐구", "신학·분석", "지성"],
    features: [
      "성경·신학·세계관을 깊이 공부하며 논리적인 흐름을 정확히 이해하고 정리하려 합니다.",
      "복잡한 개념을 구조화하고 글·노트·설명으로 깔끔하게 표현하는 재능이 있습니다.",
      "감정적 분위기보다 내용의 정확성과 진리를 우선하며, 애매한 표현이 보이면 더 명확한 언어로 정리하고 싶어 합니다.",
      "대화를 들을 때도 핵심 논점과 논리적 빈틈을 빠르게 파악하는 편입니다."
    ],
    growth: [
      "알고 있는 내용을 삶과 관계에서 ‘한 가지씩’ 실천해 보는 작은 행동이 신앙의 균형에 큰 도움이 됩니다.",
      "사람의 마음을 향한 따뜻한 관심과 짧은 공감 문장을 의식적으로 연습해 보세요.",
      "완벽한 이해가 먼저가 아니라, 부분적인 순종이 하나님 앞에서 더 중요한 때가 있음을 기억하세요.",
      "논쟁의 승패보다 ‘함께 진리를 찾아가는 동행’을 목표로 할 때, 관계와 진리가 동시에 자랍니다."
    ],
    bibleCharacter: "누가", bibleCharacterDesc: "모든 사실을 자세히 조사해 복음서와 사도행전을 기록한 의사 누가처럼, 분석과 기록을 통해 진리를 선명하게 세우는 모습이 INTP와 잘 닮았습니다.",
    verseRef: "누가복음 1:3", verseText: "그 모든 일을 근원부터 자세히 미루어 살핀 나도 데오빌로 각하에게 차례대로 써 보내는 것이 좋은 줄 알았노니",
    characterEmoji: "📚", characterTitle: "기록과 분별의 연구자", characterStory: "기록과 정리를 통해 진리를 더 선명하게 보이게 만드는 사람입니다. 당신이 만든 요약 노트, 학습 자료, FAQ 문서 덕분에 많은 사람이 ‘이제야 조금 알 것 같다’는 안도감을 느끼고, 복잡했던 질문들이 하나씩 정리됩니다.",
    ministries: ["성경 연구/공부", "문서 사역", "기술/아이디어 지원", "교리 교육"],
    strengthShort: "깊이 있는 이해와 논리로 진리를 설명하고, 공동체의 신앙 내용을 단단하게 세우는 데 탁월합니다.",
    weaknessShort: "머릿속에만 머물고 행동으로 옮기지 못할 위험이 있으며, 차갑게 느껴지는 표현으로 사람을 상처 입힐 수 있습니다.",
    warningShort: "완벽히 이해해야만 순종할 수 있다고 느끼지 않도록 주의해야 합니다. 신앙은 때로 ‘불완전한 이해 속 작은 순종’에서 자랍니다.",
    verseApply: "당신의 탐구와 기록이 사람들을 예수님께 더 가까이 이끄는 통로가 되도록 돕는 말씀입니다. 오늘은 공부한 내용 중 ‘실제로 하나 바꿀 수 있는 적용’을 정해 적어 보고, 작게라도 실천해 보세요."
  },
  INFP: {
    nameKo: "소명의 시인", nameEn: "The Idealistic Dreamer",
    summary: "어떤 일을 하든 ‘마음의 진정성’을 가장 중요하게 여기는 이상가형 제자입니다. 겉으로는 조용해 보여도, 내면에서는 “이 방향이 하나님께 기쁨이 될까?”, “이 선택이 양심에 평안한가?”를 깊이 묻습니다. 화려하지 않아도, 말이 많지 않아도, 당신이 있는 공동체에는 자연스러운 따뜻함과 진심의 분위기가 흐릅니다.",
    badges: ["가치·소명", "공감·상상", "진정성"],
    features: [
      "내면의 양심과 가치가 허락하지 않으면, 주변 분위기와 상관없이 조용히 거리를 두는 편입니다.",
      "시·글·기도·예술 등 ‘마음의 언어’로 자신의 생각과 신앙을 표현하는 것을 좋아합니다.",
      "연약한 이들의 아픔에 쉽게 이입하고, 말보다 먼저 마음으로 공감하며 함께 울어 줄 수 있습니다.",
      "관계와 사역 안에서 형식보다 진정성과 진심을 매우 중요하게 여깁니다."
    ],
    growth: [
      "마음속의 높은 이상을 ‘작은 실천 한 가지’로 옮기는 연습이 필요합니다.",
      "실망과 상처가 있어도, 공동체와 완전히 끊지 않고 적당한 거리를 두며 계속 연결되어 있는 것이 중요합니다.",
      "감정의 파도 속에서도 변하지 않는 하나님의 진리와 약속을 붙드는 습관을 세워 보세요.",
      "‘완벽한 모임’과 ‘완벽한 분위기’를 기다리기보다, 지금 가능한 한 걸음을 선택하는 용기를 내 보세요."
    ],
    bibleCharacter: "예레미야", bibleCharacterDesc: "하나님의 마음을 깊이 느끼고 눈물로 기도했던 선지자입니다. 예민하고 깊은 마음으로 시대와 하나님의 뜻 사이에서 씨름했던 모습이 INFP와 닮았습니다.",
    verseRef: "예레미야 20:9", verseText: "내가 다시는 여호와를 선포하지 아니하며 그의 이름으로 말하지 아니하리라 하면 나의 마음이 불붙는 것 같아서 골수에 사무치니 답답하여 견딜 수 없나이다",
    characterEmoji: "🕊️", characterTitle: "마음으로 기도하는 시인", characterStory: "말로 다 하지 못하는 감정을 기도와 글로 쏟아내며, 하나님께 올려 드리는 사람입니다. 당신의 노트와 일기는 때로 눈물로 젖어 있지만, 그 안에는 하나님께만 털어놓은 가장 솔직한 고백들이 가득합니다. 그 고백은 언젠가 누군가를 살리는 기도와 시가 됩니다.",
    ministries: ["중보기도", "상담/긍휼 사역", "문화/예술", "일대일 양육"],
    strengthShort: "깊고 순수한 마음으로 하나님과 사람을 사랑하며, 상처 입은 이들을 섬세하게 품어 줄 수 있습니다.",
    weaknessShort: "현실의 거친 면을 마주할 때 쉽게 상처받을 수 있고, 실망이 클수록 관계와 공동체에서 멀어지려는 경향이 있습니다.",
    warningShort: "실망 때문에 마음의 문을 닫아 버리면, 하나님께 받은 부르심과 아름다운 가능성도 함께 가려질 수 있습니다.",
    verseApply: "당신의 마음속에 있는 불씨가 하나님 안에서 꺼지지 않도록 붙들어 주는 말씀입니다. 오늘은 감정 한 줄과 말씀 한 줄을 적어 짧은 기도시로 써 보고, 한 사람과 나누거나 하나님께만 조용히 올려 드려 보세요."
  }
};


/* =========================================
   2. DOM 요소 및 초기화 (DOMContentLoaded)
   ========================================= */

document.addEventListener('DOMContentLoaded', () => {

  const dom = {
    sections: {
      intro: document.getElementById("intro-section"),
      test: document.getElementById("test-section"),
      result: document.getElementById("result-section"),
      church: document.getElementById("church-section")
    },
    btns: {
      start: document.getElementById("start-btn"),
      back: document.getElementById("back-btn"),
      skip: document.getElementById("skip-btn"),
      restart: document.getElementById("restart-btn"),
      share: document.getElementById("share-btn"),
      goResult: document.getElementById("go-result-btn"),
      bibleToggle: document.getElementById("bible-toggle-btn"),
      todayVerse: document.getElementById("today-verse-btn"),
      church: document.getElementById("church-btn"),
      churchClose: document.getElementById("church-close-btn"),
      memberSave: document.getElementById("member-save-btn"),
      churchSummary: document.getElementById("church-summary-btn"),
      churchAnalysis: document.getElementById("church-analysis-btn"), 
      invite: document.getElementById("invite-btn"),
      churchCopy: document.getElementById("church-copy-btn"),
      fontUp: document.getElementById("font-up"),
      fontDown: document.getElementById("font-down"),
      fontReset: document.getElementById("font-reset")
    },
    progress: {
      label: document.getElementById("progress-label"),
      fill: document.getElementById("progress-fill")
    },
    question: {
      code: document.getElementById("question-code"),
      text: document.getElementById("question-text"),
      inputs: document.getElementById("scale-inputs")
    },
    result: {
      code: document.getElementById("result-code"),
      name: document.getElementById("result-name"),
      summary: document.getElementById("result-summary"),
      badges: document.getElementById("result-badges"),
      features: document.getElementById("result-features"),
      growth: document.getElementById("result-growth"),
      strength: document.getElementById("result-strength"),
      weakness: document.getElementById("result-weakness"),
      warning: document.getElementById("result-warning"),
      ministries: document.getElementById("result-ministries"),
      axis: document.getElementById("axis-upgraded"),
      detail: document.getElementById("detail-score-list"),
      matchTop2: document.getElementById("match-top2"),
      matchOpposite: document.getElementById("match-opposite"),
      otherTypes: document.getElementById("other-types-grid")
    },
    bible: {
      charEl: document.getElementById("bible-character"),
      verseEl: document.getElementById("bible-verse"),
      box: document.getElementById("bible-box")
    },
    character: {
      emoji: document.getElementById("character-emoji"),
      title: document.getElementById("character-title"),
      text: document.getElementById("character-text")
    },
    verse: {
      box: document.getElementById("today-verse-box"),
      ref: document.getElementById("today-verse-box-ref"),
      text: document.getElementById("today-verse-box-text"),
      apply: document.getElementById("today-verse-box-apply")
    },
    inputs: {
      memberName: document.getElementById("member-name-input"),
      memberChurch: document.getElementById("member-church-input"),
      memberPw: document.getElementById("member-password-input"),
      viewChurch: document.getElementById("view-church-input"),
      viewPw: document.getElementById("view-password-input"),
      rememberCreds: document.getElementById("remember-creds-input")
    },
    churchList: document.getElementById("church-result-list"),
    churchAnalysisResult: document.getElementById("church-analysis-result"),
    churchViewToggle: document.getElementById("church-view-toggle"),
    churchViewContent: document.getElementById("church-view-content")
  };

  // 전역 상태 변수 (이벤트 핸들러에서 접근 가능하도록 상위 스코프에 있지만, 값은 여기서 초기화)
  let currentIndex = 0;
  let questions = []; 
  const answers = {};
  let myResultType = null;
  let currentViewType = null;
  let currentChurchMembers = []; 

  /* =========================================
     3. 함수 정의
     ========================================= */

  function shuffle(array) {
    const arr = array.slice();
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
  }

  function renderScale(questionId) {
    if (!dom.question.inputs) return;
    const container = dom.question.inputs;
    container.innerHTML = "";
    
    const fragment = document.createDocumentFragment();
    const currentValue = answers[questionId] || null;

    for (let i = 1; i <= 5; i++) {
      const label = document.createElement("label");
      label.className = "scale-option";

      const input = document.createElement("input");
      input.type = "radio";
      input.name = "scale";
      input.value = String(i);
      input.checked = currentValue === i;

      const pill = document.createElement("div");
      pill.className = "scale-pill";
      pill.textContent = i;

      const handleSelect = () => {
        answers[questionId] = i;
        goNextOrResult();
      };

      input.addEventListener("change", handleSelect);
      pill.addEventListener("click", () => {
        input.checked = true;
        handleSelect();
      });

      label.appendChild(input);
      label.appendChild(pill);
      fragment.appendChild(label);
    }
    container.appendChild(fragment);
  }

  function renderQuestion() {
    const q = questions[currentIndex];
    const idx = currentIndex + 1;
    const total = questions.length;

    if(dom.progress.label) dom.progress.label.textContent = `문항 ${idx} / ${total}`;
    if(dom.progress.fill) dom.progress.fill.style.width = `${(idx / total) * 100}%`;

    if(dom.question.code) dom.question.code.textContent = `Q${idx}`;
    if(dom.question.text) dom.question.text.textContent = q.text;

    renderScale(q.id);
    
    if(dom.btns.back) dom.btns.back.disabled = false; 
  }

  function calculateResult() {
    const scores = { E: 0, I: 0, S: 0, N: 0, T: 0, F: 0, J: 0, P: 0 };
    const axisScores = { EI: 0, SN: 0, TF: 0, JP: 0 };

    originalQuestions.forEach((q) => {
      const v = answers[q.id];
      if (!v) return;

      scores[q.side] += v;
      const centered = v - 3;

      if (q.axis === "EI") axisScores.EI += q.side === "E" ? centered : -centered;
      else if (q.axis === "SN") axisScores.SN += q.side === "S" ? centered : -centered;
      else if (q.axis === "TF") axisScores.TF += q.side === "T" ? centered : -centered;
      else if (q.axis === "JP") axisScores.JP += q.side === "J" ? centered : -centered;
    });

    const type =
      (axisScores.EI >= 0 ? "E" : "I") +
      (axisScores.SN >= 0 ? "S" : "N") +
      (axisScores.TF >= 0 ? "T" : "F") +
      (axisScores.JP >= 0 ? "J" : "P");

    return { type, scores, axisScores };
  }

  function goNextOrResult() {
    if (currentIndex < questions.length - 1) {
      currentIndex++;
      renderQuestion();
    } else {
      dom.sections.test.classList.add("hidden");
      dom.sections.result.classList.remove("hidden");

      const { type, scores, axisScores } = calculateResult();
      
      const resultData = {
        type: type,
        scores: scores,
        axisScores: axisScores,
        date: new Date().getTime()
      };
      localStorage.setItem('faith_result_v1', JSON.stringify(resultData));

      myResultType = type;
      currentViewType = type;

      renderResult(type);
      renderAxisUpgraded(axisScores);
      renderDetailScores(scores);
      renderMatchCards(type);
      buildOtherTypesGrid();
    }
  }

  function renderResult(type) {
    const data = typeResults[type];

    if(dom.result.code) dom.result.code.textContent = type;
    if(dom.result.name) dom.result.name.textContent = `${data.nameKo} · ${data.nameEn}`;
    if(dom.result.summary) dom.result.summary.textContent = data.summary;

    if(dom.result.badges) {
      dom.result.badges.innerHTML = "";
      data.badges.forEach(b => {
        const span = document.createElement("span");
        span.className = "badge";
        span.textContent = b;
        dom.result.badges.appendChild(span);
      });
    }

    const renderList = (el, items) => {
      if(!el) return;
      el.innerHTML = "";
      items.forEach(item => {
        const li = document.createElement("li");
        li.textContent = item;
        el.appendChild(li);
      });
    };

    renderList(dom.result.features, data.features);
    renderList(dom.result.growth, data.growth);
    renderList(dom.result.ministries, data.ministries);

    if(dom.result.strength) dom.result.strength.textContent = `강점: ${data.strengthShort}`;
    if(dom.result.weakness) dom.result.weakness.textContent = `약점: ${data.weaknessShort}`;
    if(dom.result.warning) dom.result.warning.textContent = data.warningShort;

    if(dom.bible.charEl) dom.bible.charEl.textContent = `${data.bibleCharacter} – ${data.bibleCharacterDesc}`;
    if(dom.bible.verseEl) dom.bible.verseEl.textContent = `${data.verseRef} ${data.verseText}`;
    if(dom.bible.box) dom.bible.box.classList.add("hidden");
    if(dom.btns.bibleToggle) dom.btns.bibleToggle.textContent = "📖 성경 인물 보기";
    
    if(dom.verse.box) dom.verse.box.classList.add("hidden");

    if(dom.character.emoji) dom.character.emoji.textContent = data.characterEmoji;
    if(dom.character.title) dom.character.title.textContent = data.characterTitle;
    if(dom.character.text) dom.character.text.textContent = data.characterStory;
  }

  function renderAxisUpgraded(axisScores) {
    if(!dom.result.axis) return;
    const defs = [
      { key: "EI", left: "E", right: "I", label: "에너지 방향" },
      { key: "SN", left: "S", right: "N", label: "정보 인식" },
      { key: "TF", left: "T", right: "F", label: "판단 기준" },
      { key: "JP", left: "J", right: "P", label: "생활 방식" }
    ];
    const MAX = 20;
    
    let html = "";
    defs.forEach(d => {
      const v = axisScores[d.key] || 0;
      let leftPercent = Math.max(0, Math.min(100, Math.round(50 + (v / (2 * MAX)) * 100)));
      const rightPercent = 100 - leftPercent;

      html += `
        <div class="axis-row">
          <div class="axis-label">
            <span>${d.label}</span>
            <span class="axis-sub-label">${d.left} ${leftPercent}% · ${d.right} ${rightPercent}%</span>
          </div>
          <div class="axis-bar-bg"><div class="axis-bar-fill" style="width:${leftPercent}%"></div></div>
        </div>`;
    });
    dom.result.axis.innerHTML = html;
  }

  function renderDetailScores(scores) {
    if(!dom.result.detail) return;
    const maxScore = 25;
    let html = "";
    ["E", "I", "S", "N", "T", "F", "J", "P"].forEach(k => {
      const v = scores[k] || 0;
      const percent = Math.min(100, Math.round((v / maxScore) * 100));
      html += `
        <div class="detail-score-row">
          <div class="detail-score-label">${k} (${v})</div>
          <div class="detail-score-bar-bg"><div class="detail-score-bar-fill" style="width:${percent}%"></div></div>
        </div>`;
    });
    dom.result.detail.innerHTML = html;
  }

  function similarityScore(a, b) {
    let s = 0;
    for (let i = 0; i < 4; i++) if (a[i] === b[i]) s++;
    return s;
  }

  function renderMatchCards(type) {
    const entries = Object.entries(typeResults);
    const all = entries
      .filter(([code]) => code !== type)
      .map(([code, data]) => ({ code, data, sim: similarityScore(type, code) }));

    const top2 = [...all].sort((a, b) => b.sim - a.sim).slice(0, 2);
    const opposite = [...all].sort((a, b) => a.sim - b.sim)[0];

    if (dom.result.matchTop2) {
      dom.result.matchTop2.innerHTML = top2.map(t => `
        <div class="match-item">
          <div class="match-item-title">${t.data.nameKo} (${t.code})</div>
          <div class="match-item-sub">${t.data.strengthShort}</div>
        </div>`).join('');
    }

    if (dom.result.matchOpposite) {
      dom.result.matchOpposite.innerHTML = `
        <div class="match-item match-item-opposite">
          <div class="match-item-title">${opposite.data.nameKo} (${opposite.code})</div>
          <div class="match-item-sub">${opposite.data.strengthShort}</div>
        </div>`;
    }
  }

  function buildOtherTypesGrid() {
    if(!dom.result.otherTypes) return;
    dom.result.otherTypes.innerHTML = "";
    Object.keys(typeResults).sort().forEach(t => {
      const btn = document.createElement("button");
      btn.className = "btn-type";
      btn.dataset.type = t;
      btn.innerHTML = `<strong>${t}</strong>`;
      btn.addEventListener("click", () => {
        currentViewType = t;
        renderResult(t);
        renderMatchCards(t);
        updateTypeButtonsActive();
      });
      dom.result.otherTypes.appendChild(btn);
    });
    updateTypeButtonsActive();
  }

  function updateTypeButtonsActive() {
    document.querySelectorAll(".btn-type").forEach(btn => {
      btn.classList.toggle("active", btn.dataset.type === currentViewType);
    });
  }

  /* 4. 이벤트 핸들러 */

  if (dom.btns.todayVerse) {
    dom.btns.todayVerse.addEventListener("click", () => {
      const type = currentViewType || myResultType;
      if (!type) return;
      const data = typeResults[type];
      dom.verse.ref.textContent = data.verseRef;
      dom.verse.text.textContent = data.verseText;
      dom.verse.apply.textContent = data.verseApply || "";
      dom.verse.box.classList.toggle("hidden");
    });
  }

  if (dom.btns.bibleToggle) {
    dom.btns.bibleToggle.addEventListener("click", () => {
      const isHidden = dom.bible.box.classList.contains("hidden");
      dom.bible.box.classList.toggle("hidden");
      dom.btns.bibleToggle.textContent = isHidden ? "📖 성경 인물 닫기" : "📖 성경 인물 보기";
    });
  }

  // 공유하기
  if (dom.btns.share) {
    dom.btns.share.addEventListener("click", async () => {
      const targetType = myResultType || currentViewType;

      if (!targetType) return alert("먼저 검사를 완료하거나, 공유할 유형을 선택해 주세요.");
      
      const baseUrl = "https://faiths.life/";
      const data = typeResults[targetType];
      
      const shareTitle = "FAITH MBTI 신앙 유형 테스트";
      const shareDesc = `나의 유형은 ${targetType} (${data.nameKo}) 입니다.`;

      if (typeof Kakao !== "undefined" && Kakao.isInitialized && Kakao.isInitialized()) {
        try {
          Kakao.Share.sendDefault({
            objectType: "feed",
            content: {
              title: shareTitle,
              description: shareDesc,
              imageUrl: "https://csy870617.github.io/faith-mbti/images/thumbnail.jpg",
              link: { mobileWebUrl: baseUrl, webUrl: baseUrl },
            },
            buttons: [{ title: "테스트 하러가기", link: { mobileWebUrl: baseUrl, webUrl: baseUrl } }]
          });
          return; 
        } catch (e) { console.error(e); }
      }
      
      if (navigator.share) {
        try { 
          await navigator.share({ 
            title: shareTitle, 
            text: shareDesc, 
            url: baseUrl 
          }); 
          return; 
        } catch(e) {}
      }
      
      try { 
        await navigator.clipboard.writeText(`${shareTitle}\n${shareDesc}\n${baseUrl}`); 
        alert("결과가 클립보드에 복사되었습니다."); 
      }
      catch (e) { alert("공유 기능을 사용할 수 없습니다."); }
    });
  }

  // 시작 버튼
  if (dom.btns.start) {
    dom.btns.start.addEventListener("click", () => {
      localStorage.removeItem('faith_result_v1');
      if (!originalQuestions) {
          alert("데이터 로딩 중입니다.");
          return;
      }
      questions = shuffle(originalQuestions);
      for (let k in answers) delete answers[k];
      currentIndex = 0;
      myResultType = null;
      currentViewType = null;

      dom.verse.box.classList.add("hidden");
      dom.bible.box.classList.add("hidden");
      dom.sections.intro.classList.add("hidden");
      dom.sections.test.classList.remove("hidden");
      dom.sections.result.classList.add("hidden");

      renderQuestion();
    });
  }

  // 이전 버튼
  if (dom.btns.back) {
    dom.btns.back.addEventListener("click", () => {
      if (currentIndex > 0) {
        currentIndex--;
        renderQuestion();
      } else {
        dom.sections.test.classList.add("hidden");
        dom.sections.intro.classList.remove("hidden");
      }
    });
  }

  if (dom.btns.skip) {
    dom.btns.skip.addEventListener("click", goNextOrResult);
  }

  // 처음으로 버튼
  if (dom.btns.restart) {
    dom.btns.restart.addEventListener("click", () => {
      if(confirm("결과가 초기화됩니다. 처음 화면으로 돌아가시겠습니까?")) {
        localStorage.removeItem('faith_result_v1');
        myResultType = null;
        currentViewType = null;
        dom.sections.result.classList.add("hidden");
        dom.sections.intro.classList.remove("hidden");
      }
    });
  }

  // 개발용 버튼
  if (dom.btns.goResult) {
    dom.btns.goResult.addEventListener("click", () => {
      localStorage.removeItem('faith_result_v1');
      myResultType = null;
      
      currentViewType = "ENFJ";
      
      const dummyScores = { E: 20, I: 5, S: 20, N: 5, T: 20, F: 5, J: 20, P: 5 };
      const dummyAxis = { EI: 15, SN: 15, TF: 15, JP: 15 };

      dom.sections.intro.classList.add("hidden");
      dom.sections.test.classList.add("hidden");
      dom.sections.result.classList.remove("hidden");

      renderResult("ENFJ");
      renderAxisUpgraded(dummyAxis);
      renderDetailScores(dummyScores);
      renderMatchCards("ENFJ");
      buildOtherTypesGrid();
    });
  }

  /* 5. Firebase & 우리교회 */
  const CHURCH_COLLECTION = "faith_churches";
  let _firebaseDb = null, _firebaseFsModule = null;

  async function ensureFirebase() {
    if (_firebaseDb && _firebaseFsModule) return { db: _firebaseDb, fs: _firebaseFsModule };
    const appMod = await import("https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js");
    const fsMod = await import("https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js");
    const app = appMod.initializeApp({
      apiKey: "AIzaSyDAigdc0C7zzzOySBTFb527eeAN3jInIfQ",
      authDomain: "faith-mbti.firebaseapp.com",
      projectId: "faith-mbti",
      storageBucket: "faith-mbti.firebasestorage.app",
      messagingSenderId: "1065834838710",
      appId: "1:1065834838710:web:33382f9a82f94d112e8417",
      measurementId: "G-RWMSVFRMRP"
    });
    return { db: (_firebaseDb = fsMod.getFirestore(app)), fs: (_firebaseFsModule = fsMod) };
  }

  async function saveMyResultToChurch(name, churchName, password) {
    const n = name.trim(), c = churchName.trim(), p = password.trim();
    if (!n || !c || !p) throw new Error("모든 항목을 입력해 주세요.");

    const targetType = currentViewType || myResultType;
    if (!targetType) throw new Error("먼저 검사를 완료하거나, '다른 유형 보기'에서 내 유형을 선택해 주세요.");

    const { db, fs } = await ensureFirebase();
    const churchRef = fs.doc(db, CHURCH_COLLECTION, c);
    const snap = await fs.getDoc(churchRef);

    if (snap.exists() && snap.data().password !== p) throw new Error("비밀번호가 일치하지 않습니다.");
    if (!snap.exists()) await fs.setDoc(churchRef, { churchName: c, password: p, createdAt: fs.serverTimestamp ? fs.serverTimestamp() : Date.now() });

    const data = typeResults[targetType];
    await fs.addDoc(fs.collection(churchRef, "members"), {
      name: n, 
      type: targetType, 
      shortText: data.summary || data.nameKo || "",
      createdAt: fs.serverTimestamp ? fs.serverTimestamp() : Date.now()
    });
  }

  async function loadChurchMembers(churchName, password) {
    const c = churchName.trim(), p = password.trim();
    if (!c || !p) throw new Error("정보를 모두 입력해 주세요.");

    const { db, fs } = await ensureFirebase();
    const churchRef = fs.doc(db, CHURCH_COLLECTION, c);
    const snap = await fs.getDoc(churchRef);

    if (!snap.exists()) throw new Error("등록된 교회가 없습니다.");
    if (snap.data().password !== p) throw new Error("비밀번호가 일치하지 않습니다.");

    const q = fs.query(fs.collection(churchRef, "members"), fs.orderBy("createdAt", "asc"));
    const membersSnap = await fs.getDocs(q);
    
    const membersData = membersSnap.docs.map(d => ({ id: d.id, ...d.data() }));
    currentChurchMembers = membersData;

    return { churchName: snap.data().churchName || c, members: membersData };
  }

  async function deleteChurchMember(churchName, password, memberId) {
    const { db, fs } = await ensureFirebase();
    const churchRef = fs.doc(db, CHURCH_COLLECTION, churchName.trim());
    const snap = await fs.getDoc(churchRef);
    
    if (!snap.exists() || snap.data().password !== password.trim()) throw new Error("권한이 없습니다.");
    await fs.deleteDoc(fs.doc(fs.collection(churchRef, "members"), memberId));
  }

  function renderChurchList(churchName, members) {
    if (!dom.churchList) return;
    if (!members || !members.length) {
      dom.churchList.innerHTML = `<div class="result-card"><p class="gray">저장된 결과가 없습니다.</p></div>`;
      return;
    }
    const rows = members.map(m => {
      const typeData = typeResults[m.type];
      const desc = typeData ? typeData.strengthShort : (m.shortText || "");
      return `
      <tr>
        <td>${m.name || ""}</td><td>${m.type || ""}</td><td>${desc}</td>
        <td><button class="btn-secondary member-delete-btn" data-id="${m.id}" data-church="${churchName}">삭제</button></td>
      </tr>`;
    }).join('');
      
    dom.churchList.innerHTML = `
      <div class="result-card"><div class="card-title">🏠 ${churchName}</div>
        <div style="overflow-x:auto;">
          <table style="width:100%;border-collapse:collapse;font-size:12px;">
            <thead><tr style="border-bottom:1px solid #e5e7eb;"><th>이름</th><th>유형</th><th>설명</th><th>관리</th></tr></thead>
            <tbody>${rows}</tbody>
          </table>
        </div>
      </div>`;

    dom.churchList.querySelectorAll(".member-delete-btn").forEach(btn => {
      btn.addEventListener("click", async () => {
        const pw = prompt("우리교회 비밀번호를 입력해 주세요.");
        if (!pw) return;
        try {
          await deleteChurchMember(btn.dataset.church, pw, btn.dataset.id);
          alert("삭제되었습니다.");
          const { members: refreshed } = await loadChurchMembers(btn.dataset.church, pw);
          renderChurchList(btn.dataset.church, refreshed);
        } catch (e) { alert(e.message); }
      });
    });
  }

  // 공동체 분석 로직
  function analyzeAndRenderCommunity() {
    const members = currentChurchMembers;
    if (!members || members.length === 0) {
      alert("먼저 [공동체 유형 확인] 버튼을 눌러 데이터를 불러와 주세요.");
      return;
    }

    const total = members.length;
    const counts = { E:0, I:0, S:0, N:0, T:0, F:0, J:0, P:0 };
    const typeCounts = {};

    members.forEach(m => {
      const t = m.type; 
      if (!t || t.length !== 4) return;
      counts[t[0]]++; counts[t[1]]++; counts[t[2]]++; counts[t[3]]++;
      typeCounts[t] = (typeCounts[t] || 0) + 1;
    });

    let maxVal = 0;
    for (const v of Object.values(typeCounts)) {
      if (v > maxVal) maxVal = v;
    }
    const maxTypes = [];
    for (const [t, v] of Object.entries(typeCounts)) {
      if (v === maxVal) maxTypes.push(t);
    }
    const maxTypeDisplay = maxTypes.join(", ");
    const isTie = maxTypes.length > 1;

    const domE = counts.E === counts.I ? "E/I" : (counts.E > counts.I ? "E" : "I");
    const domS = counts.S === counts.N ? "S/N" : (counts.S > counts.N ? "S" : "N");
    const domT = counts.T === counts.F ? "T/F" : (counts.T > counts.F ? "T" : "F");
    const domJ = counts.J === counts.P ? "J/P" : (counts.J > counts.P ? "J" : "P");
    
    const displayCode = `${domE} - ${domS} - ${domT} - ${domJ}`;

    const safeE = counts.E >= counts.I ? "E" : "I";
    const safeS = counts.S >= counts.N ? "S" : "N";
    const safeT = counts.T >= counts.F ? "T" : "F";
    const safeJ = counts.J >= counts.P ? "J" : "P";
    const lookupCode = safeE + safeS + safeT + safeJ;

    const topTypeName = typeResults[lookupCode] ? typeResults[lookupCode].nameKo : lookupCode;
    const isHybrid = (counts.E === counts.I) || (counts.S === counts.N) || (counts.T === counts.F) || (counts.J === counts.P);
    const typeBadge = isHybrid ? '<span class="badge badge-balanced" style="font-size:0.75rem; margin-left:6px;">복합/균형 성향</span>' : '';

    let html = `
      <div class="analysis-box">
        <div class="analysis-header">📊 우리 공동체 영적 DNA</div>
        <div class="analysis-summary-grid">
          <div class="summary-item">
            <div class="summary-val">${total}명</div>
            <div class="summary-label">분석 인원</div>
            ${total < 5 ? '<div style="font-size:0.8rem; color:#ef4444; margin-top:4px;">⚠ 5명 미만은 분석이 정확하지 않아요</div>' : '<div style="font-size:0.8rem; color:#6b7280; margin-top:4px;">💡 5명 이상일 때 분석이 더 정확해요</div>'}
          </div>
          <div class="summary-item">
            <div class="summary-val" style="font-size:${isTie ? '1rem' : '1.25rem'}">
              ${maxTypeDisplay}
            </div>
            <div class="summary-label">
              최다 유형 (${maxVal}명) ${isTie ? '<span class="badge badge-leaning" style="font-size:0.6rem; vertical-align:middle;">공동</span>' : ''}
            </div>
          </div>
        </div>

        <div class="insight-text" style="text-align:center; margin-top:16px;">
          우리의 대표 성향은 <span class="insight-highlight">${displayCode}</span> 입니다.<br/>
          <div style="margin-top:4px; font-weight:600; color:#4b5563;">
            "${topTypeName}" ${typeBadge}
          </div>
          <div style="margin-top:12px; font-size:0.8rem; color:#94a3b8; line-height:1.5;">
            ※ 이 분석은 에너지 비율에 따른 경향성일 뿐,<br/>
            공동체 전체를 절대적으로 규정하는 것은 아닙니다.
          </div>
        </div>
      </div>

      <div class="analysis-box">
        <div class="analysis-header">⚖️ 에너지 균형 (Energy Balance)</div>
        ${renderBarEnhanced("관계 에너지", "외향 (E)", counts.E, "내향 (I)", counts.I, total)}
        ${renderBarEnhanced("인식 스타일", "현실 (S)", counts.S, "이상 (N)", counts.N, total)}
        ${renderBarEnhanced("판단 기준", "이성 (T)", counts.T, "감성 (F)", counts.F, total)}
        ${renderBarEnhanced("생활 패턴", "계획 (J)", counts.J, "유연 (P)", counts.P, total)}
      </div>

      <div class="analysis-box">
        <div class="analysis-section-title">🗣️ 우리 공동체의 모임 스타일</div>
        <div class="meeting-style-box">
          ${getMeetingStyle(counts, total)}
        </div>
      </div>

      <div class="analysis-box">
        <div class="analysis-section-title">💎 놓치지 말아야 할 '숨은 보석'</div>
        <div class="minority-box">
          ${getMinorityCare(counts, total)}
        </div>
      </div>

      <div class="analysis-box">
        <div class="analysis-section-title">🌱 우리 공동체 성장 가이드</div>
        <div class="growth-box">
          ${getDetailedGrowthGuide(counts, total)}
        </div>
      </div>

      <button id="close-analysis-btn" class="close-analysis-btn">분석 결과 닫기 ✖</button>
    `;

    if (dom.churchAnalysisResult) {
      dom.churchAnalysisResult.innerHTML = html;
      dom.churchAnalysisResult.classList.remove("hidden");
      
      document.getElementById("close-analysis-btn").addEventListener("click", () => {
        dom.churchAnalysisResult.classList.add("hidden");
        dom.btns.churchSummary.scrollIntoView({ behavior: 'smooth', block: 'center' });
      });
    }
  }

  function renderBarEnhanced(title, leftLabel, leftVal, rightLabel, rightVal, total) {
    const leftPct = Math.round((leftVal / total) * 100);
    const rightPct = 100 - leftPct;
    const gap = Math.abs(leftPct - rightPct);
    let badgeHtml = "";
    
    if (leftVal === rightVal) {
      badgeHtml = `<span class="balance-badge badge-balanced">완벽한 균형 ✨</span>`;
    } else if (gap < 15) {
      badgeHtml = `<span class="balance-badge badge-balanced">황금 밸런스 ⚖️</span>`;
    }

    const colorLeft = "#f43f5e"; // Rose
    const colorRight = "#3b82f6"; // Blue

    return `
      <div style="margin-bottom:16px;">
        <div class="analysis-label-row">
          <span>${title} ${badgeHtml}</span>
        </div>
        <div class="analysis-bar-container">
          <div style="width:${leftPct}%; background:${colorLeft}; height:100%; transition: width 1s;"></div>
          <div style="width:${rightPct}%; background:${colorRight}; height:100%; transition: width 1s;"></div>
        </div>
        <div style="display:flex; justify-content:space-between; font-size:0.75rem; color:#6b7280; margin-top:4px;">
          <span>${leftLabel} <strong>${leftVal}명</strong> (${leftPct}%)</span>
          <span>${rightLabel} <strong>${rightVal}명</strong> (${rightPct}%)</span>
        </div>
      </div>
    `;
  }

  function getMeetingStyle(c, total) {
    let text = "";
    if (c.E === c.I) {
      text += "✨ <strong>활력과 깊이의 균형:</strong> 역동적인 에너지와 차분한 묵상이 공존하는 아주 이상적인 분위기입니다. 상황에 따라 유연하게 모임을 이끌 수 있습니다.<br/><br/>";
    } else if (c.E > c.I) {
      text += "🎤 <strong>활기차고 에너지가 넘쳐요.</strong> 누군가 먼저 말을 꺼내고 분위기를 주도하는 것이 자연스럽습니다. 다만 목소리 큰 사람 위주로 흘러가지 않도록 주의하세요.<br/><br/>";
    } else {
      text += "☕ <strong>차분하고 깊이가 있어요.</strong> 왁자지껄하기보다 소그룹으로 깊게 나누는 것을 선호합니다. 침묵을 어색해하지 마세요.<br/><br/>";
    }

    if (c.J === c.P) {
      text += "🤝 <strong>계획과 유연함의 조화!</strong> 큰 틀은 지키되 상황에 맞춰 융통성을 발휘할 줄 아는 성숙한 모임입니다.";
    } else if (c.J > c.P) {
      text += "📅 <strong>계획대로 착착!</strong> 시작과 끝 시간이 명확하고, 정해진 순서대로 진행되는 것을 좋아합니다. 돌발 상황에는 당황할 수 있어요.";
    } else {
      text += "🌊 <strong>그때그때 유연하게!</strong> 순서가 바뀌거나 새로운 나눔이 길어져도 즐겁게 받아들입니다. 하지만 결론 없이 끝날 수도 있으니 마무리를 챙겨주세요.";
    }
    return text;
  }

  function getMinorityCare(c, total) {
    const minorities = [];
    const threshold = total * 0.4; 

    if (c.I < threshold && c.I > 0) minorities.push("🤫 <strong>내향형(I) 지체들:</strong> 에너지가 너무 높은 모임에서 기가 빨릴 수 있어요. 생각할 시간을 주세요.");
    if (c.E < threshold && c.E > 0) minorities.push("📣 <strong>외향형(E) 지체들:</strong> 너무 차분하면 답답할 수 있어요. 에너지를 발산할 기회를 주세요.");
    if (c.S < threshold && c.S > 0) minorities.push("👀 <strong>현실형(S) 지체들:</strong> 뜬구름 잡는 비전 나눔보다 '이번 주에 당장 무엇을 할지' 구체적인 적용점을 좋아해요.");
    if (c.N < threshold && c.N > 0) minorities.push("🌈 <strong>직관형(N) 지체들:</strong> 반복되는 일상 나눔을 지루해할 수 있어요. '우리 공동체의 꿈'이나 '하나님 나라' 같은 깊은 주제를 던져주세요.");
    if (c.F < threshold && c.F > 0) minorities.push("💖 <strong>감정형(F) 지체들:</strong> 일 처리보다 '서로의 마음'을 확인받고 싶어 해요. 공감의 시간이 필요해요.");
    if (c.T < threshold && c.T > 0) minorities.push("🤔 <strong>사고형(T) 지체들:</strong> 감정 호소만으로는 설득되지 않아요. 논리적인 이유를 설명해 주세요.");

    if (minorities.length === 0) {
      return "⚖️ <strong>치우침 없이 조화로워요!</strong><br/>서로 다른 은사를 가진 지체들이 골고루 섞여 있습니다. 이 다양성을 유지하며 서로 배우는 관계가 되세요.";
    }
    return minorities.join("<br/><br/>");
  }

  function getDetailedGrowthGuide(c, total) {
    const guides = [];

    if (c.E === c.I) guides.push(`<div class="growth-item"><div class="growth-icon">⚖️</div><div><strong>소통의 균형:</strong> 말하는 사람과 듣는 사람의 비율이 좋습니다. 이 건강한 밸런스를 유지하세요.</div></div>`);
    else if (c.E > c.I) guides.push(`<div class="growth-item"><div class="growth-icon">👂</div><div><strong>경청의 영성:</strong> 에너지가 넘치는 우리, 가끔은 '거룩한 침묵'의 시간을 가져보면 어떨까요?</div></div>`);
    else guides.push(`<div class="growth-item"><div class="growth-icon">🔥</div><div><strong>표현의 용기:</strong> 깊은 묵상이 있는 우리, 이제는 그 은혜를 입 밖으로 꺼내어 나누는 용기를 내보세요.</div></div>`);

    if (c.S === c.N) guides.push(`<div class="growth-item"><div class="growth-icon">🌉</div><div><strong>현실과 비전의 다리:</strong> 꿈을 꾸는 사람과 길을 만드는 사람이 함께 있어 든든합니다.</div></div>`);
    else if (c.S > c.N) guides.push(`<div class="growth-item"><div class="growth-icon">🔭</div><div><strong>거룩한 상상력:</strong> 현실에 충실한 우리, 눈앞의 문제 해결을 넘어 하나님이 그리시는 '큰 그림'을 꿈꿔보세요.</div></div>`);
    else guides.push(`<div class="growth-item"><div class="growth-icon">🧹</div><div><strong>거룩한 디테일:</strong> 비전이 큰 우리, 그 꿈을 이루기 위해 당장 오늘 해야 할 '작은 순종'을 놓치지 마세요.</div></div>`);

    if (c.T === c.F) guides.push(`<div class="growth-item"><div class="growth-icon">🤝</div><div><strong>머리와 가슴의 조화:</strong> 냉철한 판단과 따뜻한 공감이 어우러진 성숙한 공동체입니다.</div></div>`);
    else if (c.T > c.F) guides.push(`<div class="growth-item"><div class="growth-icon">💓</div><div><strong>공감의 온도:</strong> 옳은 말을 잘하는 우리, 그 정답을 전하기 전에 따뜻한 눈빛으로 마음을 먼저 녹여주세요.</div></div>`);
    else guides.push(`<div class="growth-item"><div class="growth-icon">⚖️</div><div><strong>분별의 지혜:</strong> 사랑이 넘치는 우리, 관계가 상할까 봐 덮어두기보다 건강을 위해 '사랑 안에서 진리'를 말해보세요.</div></div>`);

    if (c.J === c.P) guides.push(`<div class="growth-item"><div class="growth-icon">⚓</div><div><strong>안정과 모험:</strong> 체계적인 안정감과 상황에 따른 유연함이 모두 있습니다.</div></div>`);
    else if (c.J > c.P) guides.push(`<div class="growth-item"><div class="growth-icon">🕊️</div><div><strong>여백의 미:</strong> 계획이 철저한 우리, 계획대로 되지 않는 의외성을 기쁨으로 받아들여 보세요.</div></div>`);
    else guides.push(`<div class="growth-item"><div class="growth-icon">🧱</div><div><strong>질서의 능력:</strong> 자유로운 우리, 약속 시간과 규칙 같은 작은 질서를 지킬 때 신뢰가 더욱 단단해집니다.</div></div>`);

    return guides.join("");
  }

  if (dom.btns.church && dom.sections.church) {
    dom.btns.church.addEventListener("click", () => {
      history.pushState({ page: "church" }, "", "#church");
      dom.sections.intro.classList.add("hidden");
      dom.sections.test.classList.add("hidden");
      dom.sections.result.classList.add("hidden");
      dom.sections.church.classList.remove("hidden");
    });
  }

  // 뒤로 가기 감지
  window.addEventListener("popstate", (event) => {
    if (!dom.sections.church.classList.contains("hidden")) {
      dom.sections.church.classList.add("hidden");
      if (myResultType) dom.sections.result.classList.remove("hidden");
      else dom.sections.intro.classList.remove("hidden");
    }
  });

  if (dom.btns.churchClose) {
    dom.btns.churchClose.addEventListener("click", () => {
      if (location.hash === "#church") {
        history.back(); 
      } else {
        dom.sections.church.classList.add("hidden");
        if (myResultType) dom.sections.result.classList.remove("hidden");
        else dom.sections.intro.classList.remove("hidden");
      }
    });
  }

  if (dom.btns.memberSave) {
    dom.btns.memberSave.addEventListener("click", async () => {
      try {
        await saveMyResultToChurch(dom.inputs.memberName.value, dom.inputs.memberChurch.value, dom.inputs.memberPw.value);
        alert("저장되었습니다.");
        dom.inputs.memberName.value = "";
      } catch (e) { alert(e.message); }
    });
  }

  if (dom.btns.churchSummary) {
    dom.btns.churchSummary.addEventListener("click", async () => {
      if (dom.inputs.rememberCreds && dom.inputs.rememberCreds.checked) {
        localStorage.setItem('faith_church_name', dom.inputs.viewChurch.value);
        localStorage.setItem('faith_church_pw', dom.inputs.viewPw.value);
      } else {
        localStorage.removeItem('faith_church_name');
        localStorage.removeItem('faith_church_pw');
      }

      try {
        const { churchName, members } = await loadChurchMembers(dom.inputs.viewChurch.value, dom.inputs.viewPw.value);
        renderChurchList(churchName, members);
        if (dom.btns.churchCopy) dom.btns.churchCopy.classList.remove("hidden");
      } catch (e) { alert(e.message); }
    });
  }

  if (dom.btns.churchAnalysis) {
    dom.btns.churchAnalysis.addEventListener("click", analyzeAndRenderCommunity);
  }

  if (dom.churchViewToggle && dom.churchViewContent) {
    dom.churchViewToggle.addEventListener("click", () => {
      const isHidden = dom.churchViewContent.classList.contains("hidden");
      if (isHidden) {
        dom.churchViewContent.classList.remove("hidden");
        dom.churchViewToggle.querySelector("h3").innerText = "우리교회 신앙 유형 모아보기 ▲";
      } else {
        dom.churchViewContent.classList.add("hidden");
        dom.churchViewToggle.querySelector("h3").innerText = "우리교회 신앙 유형 모아보기 ▼";
      }
    });
  }

  if (dom.btns.invite) {
    dom.btns.invite.addEventListener("click", async () => {
      const baseUrl = "https://faiths.life";
      const rawGroupName = dom.inputs.viewChurch.value.trim();
      const groupName = rawGroupName.length > 0 ? rawGroupName : "우리교회";
      const shareTitle = `${groupName} 신앙 유형 모임 초대`;
      const shareDesc = "함께 신앙 유형을 검사하고 결과를 나눠보세요!";

      if (typeof Kakao !== "undefined" && Kakao.isInitialized && Kakao.isInitialized()) {
        try {
          Kakao.Share.sendDefault({
            objectType: "feed",
            content: {
              title: shareTitle, description: shareDesc,
              imageUrl: "https://csy870617.github.io/faith-mbti/images/thumbnail.jpg",
              link: { mobileWebUrl: baseUrl, webUrl: baseUrl },
            },
            buttons: [{ title: "모임 참여하기", link: { mobileWebUrl: baseUrl, webUrl: baseUrl } }]
          });
          return; 
        } catch (e) { console.error(e); }
      }

      if (navigator.share) {
        try { await navigator.share({ title: shareTitle, text: shareDesc, url: baseUrl }); return; } catch(e) {}
      }

      try { 
        await navigator.clipboard.writeText(`${shareTitle}\n${shareDesc}\n${baseUrl}`); 
        alert("초대 링크가 클립보드에 복사되었습니다."); 
      }
      catch (e) { alert("공유 기능을 사용할 수 없습니다."); }
    });
  }

  if (dom.btns.churchCopy) {
    dom.btns.churchCopy.addEventListener("click", async () => {
      const members = currentChurchMembers;
      if (!members || members.length === 0) return alert("복사할 데이터가 없습니다.");

      const groupName = dom.inputs.viewChurch.value.trim() || "우리교회";
      const shareHeader = `${groupName} - 신앙 유형 결과`;
      
      let shareBody = "";
      members.forEach(m => {
        const typeData = typeResults[m.type];
        const desc = typeData ? typeData.strengthShort : (m.shortText || "");
        shareBody += `이름: ${m.name}\n유형: ${m.type}\n설명: ${desc}\n\n`;
      });

      const fullText = `${shareHeader}\n\n${shareBody}`;
      
      if (typeof Kakao !== "undefined" && Kakao.isInitialized && Kakao.isInitialized()) {
        try {
          Kakao.Share.sendDefault({
            objectType: "text",
            text: fullText,
            link: { mobileWebUrl: "https://faiths.life", webUrl: "https://faiths.life" },
            buttonTitle: "검사하러 가기"
          });
          return; 
        } catch (e) { console.error(e); }
      }

      if (navigator.share) {
        try { 
          await navigator.share({ 
            title: shareHeader, 
            text: "\n\n" + shareBody 
          }); 
          return; 
        } catch(e) {}
      }

      try { 
        await navigator.clipboard.writeText(fullText); 
        alert("그룹 결과가 클립보드에 복사되었습니다."); 
      }
      catch(e) { alert("공유 기능을 사용할 수 없습니다."); }
    });
  }

  // 폰트 조절 초기화
  let currentFontScale = parseFloat(localStorage.getItem("faith_font_scale")) || 1.0;

  function applyFontSize(scale) {
    scale = Math.round(scale * 10) / 10;
    const root = document.documentElement;
    const basePercent = 120; 
    const percent = Math.round(scale * basePercent);
    root.style.fontSize = `${percent}%`;
    localStorage.setItem("faith_font_scale", scale);
    currentFontScale = scale;
  }

  if (currentFontScale !== 1.0) {
    applyFontSize(currentFontScale);
  } else {
    applyFontSize(1.0);
  }

  if (dom.btns.fontUp) {
    dom.btns.fontUp.addEventListener("click", () => {
      if (currentFontScale < 1.3) applyFontSize(currentFontScale + 0.1);
    });
    dom.btns.fontDown.addEventListener("click", () => {
      if (currentFontScale > 0.7) applyFontSize(currentFontScale - 0.1);
    });
    dom.btns.fontReset.addEventListener("click", () => {
      applyFontSize(1.0);
    });
  }

  // 저장된 결과 로드
  const savedData = localStorage.getItem('faith_result_v1');
  if (savedData) {
    try {
      const data = JSON.parse(savedData);
      if (data.type && data.scores && data.axisScores) {
        myResultType = data.type;
        currentViewType = data.type;
        
        dom.sections.intro.classList.add("hidden");
        dom.sections.test.classList.add("hidden");
        dom.sections.result.classList.remove("hidden");

        renderResult(data.type);
        renderAxisUpgraded(data.axisScores);
        renderDetailScores(data.scores);
        renderMatchCards(data.type);
        buildOtherTypesGrid();
      }
    } catch (e) {
      console.error("저장된 데이터 로드 실패", e);
      localStorage.removeItem('faith_result_v1');
    }
  }

  const savedChurch = localStorage.getItem('faith_church_name');
  const savedPw = localStorage.getItem('faith_church_pw');
  
  if (savedChurch && savedPw && dom.inputs.rememberCreds) {
    dom.inputs.viewChurch.value = savedChurch;
    dom.inputs.viewPw.value = savedPw;
    dom.inputs.rememberCreds.checked = true;
  }
});